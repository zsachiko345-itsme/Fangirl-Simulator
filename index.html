<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>åŒäººå¥³æ¨¡æ‹Ÿå™¨</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- React & ReactDOM (UMD) -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <!-- Babel Standalone -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@400;700;900&display=swap" rel="stylesheet">
    <style>
        :root {
            --ao3-red: #990000;
            --ao3-bg: #F0F0F0;
        }
        body {
            font-family: 'Noto Serif SC', serif;
            background-color: #333;
            overscroll-behavior: none;
            margin: 0;
            padding: 0;
            height: 100vh;
            display: flex;
            justify-content: center;
        }
        #root {
            width: 100%;
            max-width: 28rem; /* max-w-md */
            height: 100%;
            background: white;
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
            display: flex;
            flex-direction: column;
            overflow: hidden;
            position: relative;
        }
        .hide-scrollbar::-webkit-scrollbar {
            display: none;
        }
        .hide-scrollbar {
            -ms-overflow-style: none;
            scrollbar-width: none;
        }
        .custom-scrollbar::-webkit-scrollbar {
            width: 4px;
        }
        .custom-scrollbar::-webkit-scrollbar-track {
            background: transparent;
        }
        .custom-scrollbar::-webkit-scrollbar-thumb {
            background: #cbd5e1;
            border-radius: 2px;
        }
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        .animate-fadeIn {
            animation: fadeIn 0.3s ease-out;
        }
        @keyframes slideUp {
            from { transform: translateY(100%); }
            to { transform: translateY(0); }
        }
        .animate-slideUp {
            animation: slideUp 0.3s ease-out;
        }
        /* Shake animation for events */
        @keyframes shake {
            0% { transform: translate(1px, 1px) rotate(0deg); }
            10% { transform: translate(-1px, -2px) rotate(-1deg); }
            20% { transform: translate(-3px, 0px) rotate(1deg); }
            30% { transform: translate(3px, 2px) rotate(0deg); }
            40% { transform: translate(1px, -1px) rotate(1deg); }
            50% { transform: translate(-1px, 2px) rotate(-1deg); }
            60% { transform: translate(-3px, 1px) rotate(0deg); }
            70% { transform: translate(3px, 1px) rotate(-1deg); }
            80% { transform: translate(-1px, -1px) rotate(1deg); }
            90% { transform: translate(1px, 2px) rotate(0deg); }
            100% { transform: translate(1px, -2px) rotate(-1deg); }
        }
        .animate-shake {
            animation: shake 0.5s;
            animation-iteration-count: 1;
        }
        .safe-area-bottom {
            padding-bottom: env(safe-area-inset-bottom);
        }
    </style>
<script type="importmap">
{
  "imports": {
    "react/": "https://esm.sh/react@^19.2.4/",
    "react": "https://esm.sh/react@^19.2.4",
    "react-dom/": "https://esm.sh/react-dom@^19.2.4/"
  }
}
</script>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useCallback, useRef } = React;

        // ==========================================
        // DATA SECTION
        // ==========================================

        const JOB_MAP = { 
            'æ–‡æ‰‹': 'writer', 
            'ç”»æ‰‹': 'artist', 
            'å‰ªè¾‘': 'editor', 
            'è·¯äºº': 'passerby' 
        };

        const ACHIEVEMENTS = [
            // A: æ™‹å‡è·¯çº¿
            { id: 'ACH_01', category: 'A', tier: 1, name: 'åœˆå†…å°é€æ˜', conditionDesc: 'çƒ­åº¦ < 1,000 (é¦–æ¬¡äº§å‡ºå)', description: 'ä½ å‘å‡ºçš„å£°éŸ³åªæœ‰å›éŸ³ã€‚æ²¡å…³ç³»ï¼Œè°ä¸æ˜¯ä»é›¶å¼€å§‹çš„å‘¢ï¼Ÿ', rewardDesc: 'äº§å‡ºçƒ­åº¦ +10% (æ–°æ‰‹ä¿æŠ¤)' },
            { id: 'ACH_02', category: 'A', tier: 2, name: 'ç´«å¾®æ˜Ÿé™ä¸´', conditionDesc: 'å•æ¬¡äº§å‡º > 5,000', description: 'è€å¤©èµé¥­åƒï¼ä¸€å¤œä¹‹é—´ï¼Œä½ çš„é€šçŸ¥æ ç‚¸äº†ã€‚', rewardDesc: 'çˆ†æ¬¾ç‡ (Highäº‹ä»¶) æå‡è‡³ 40%' },
            { id: 'ACH_03', category: 'A', tier: 3, name: 'å¥³ç¥ (KOL)', conditionDesc: 'æ€»çƒ­åº¦ > 20,000', description: 'ä½ å¼€å§‹æœ‰è…¿æ¯›äº†ï¼Œç”šè‡³æœ‰äººä¸“é—¨åœ¨ä½ çš„è¯„è®ºåŒºè¹²ç‚¹ã€‚', rewardDesc: 'åŸºç¡€äº§å‡ºçƒ­åº¦ +50%' },
            { id: 'ACH_04', category: 'A', tier: 4, name: 'é•‡åœˆç¥ä»™', conditionDesc: 'æ€»çƒ­åº¦ > 100,000', description: 'åªè¦æèµ·è¿™å¯¹CPï¼Œä½ æ˜¯ç»•ä¸è¿‡å»çš„é«˜å±±ã€‚', rewardDesc: 'æ‰€æœ‰çƒ­åº¦æ”¶ç›Šç¿»å€ (x2)' },

            // B: è‚åº¦ä¸è´¢å¯Œ
            { id: 'ACH_05', category: 'B', tier: 1, name: 'åƒåœŸå°‘å¥³', conditionDesc: 'å­˜æ¬¾ < 500', description: 'ä¸ºäº†ä¹°è°·ï¼Œä½ ç”šè‡³è¿æ³¡é¢æ±¤éƒ½è¦å–å¹²å‡€ã€‚', rewardDesc: 'ç°å……æ‰“å·¥æ”¶ç›Š +20% (ç©·åˆ™æ€å˜)' },
            { id: 'ACH_06', category: 'B', tier: 2, name: 'å¯Œå©†', conditionDesc: 'å­˜æ¬¾ > 50,000', description: 'è‡ªå¸¦é’èƒ½åŠ›çš„åŒäººå¥³ã€‚ä½ å¯ä»¥ä¹°ä¸‹æ•´ä¸ªæ¼«å±•çš„æ‘Šä½ã€‚', rewardDesc: 'æ°ªé‡‘é€‰é¡¹ (Level 2/3) æ¶ˆè€— -20%' },
            { id: 'ACH_07', category: 'B', tier: 3, name: 'è‚å¸', conditionDesc: 'äº§å‡ºæ¬¡æ•° > 50', description: 'ä½ çš„æ‰‹é€Ÿæ˜¯äººç±»çš„æé™ï¼Œç”Ÿäº§é˜Ÿçš„é©´éƒ½ä¸æ•¢è¿™ä¹ˆæ­‡ã€‚', rewardDesc: 'æ¯å‘¨ AP ä¸Šé™ +1' },
            { id: 'ACH_08', category: 'B', tier: 4, name: 'é¸½å­ç²¾', conditionDesc: 'è¿ç»­ 4 å‘¨æ— äº§å‡º', description: 'å’•å’•å’•ã€‚ä½ çš„ç²‰ä¸æ­£åœ¨æåˆ€èµ¶æ¥çš„è·¯ä¸Šã€‚', rewardDesc: 'æ‘†çƒ‚å¿«ä¹ (Sanå€¼æ¶ˆè€—å‡å°‘)' },

            // C: æ€§æ ¼è·¯çº¿
            { id: 'ACH_09', category: 'C', tier: 1, name: 'äº’è”ç½‘è©è¨', conditionDesc: 'Moe (èŒ) > 80', description: 'ä½ ä»ä¸ææ¶ï¼Œåªäº§ç²®å’Œå¤¸å¤¸ã€‚ä½ æ˜¯æœ€åçš„å‡€åœŸã€‚', rewardDesc: 'äº’åŠ¨å›è¡€æ•ˆæœ +50%' },
            { id: 'ACH_10', category: 'C', tier: 2, name: 'ç²‰åœˆå¥³æ˜æ˜Ÿ', conditionDesc: 'Toxic (æ¯’) > 80', description: 'å“ªé‡Œæœ‰ç“œï¼Œå“ªé‡Œå°±æœ‰ä½ ã€‚ä½ çš„æˆ˜æ–—åŠ›è®©é»‘ç²‰é—»é£ä¸§èƒ†ã€‚', rewardDesc: 'æŒ‚äºº/åµæ¶çš„çƒ­åº¦æ”¶ç›Š +50%' },
            { id: 'ACH_11', category: 'C', tier: 3, name: 'ç«¯æ°´å¤§å¸ˆ', conditionDesc: 'èŒ/æ¯’çš†<20 ä¸”å­˜æ´»2å¹´(96å‘¨)', description: 'ä½ åœ¨æªæ—å¼¹é›¨ä¸­æ¯«å‘æ— ä¼¤ï¼Œç”šè‡³è¿˜èƒ½å²æœˆé™å¥½ã€‚', rewardDesc: 'Sanå€¼ä¸Šé™ +20' },

            // D: å½©è›‹
            { id: 'ACH_12', category: 'D', tier: 1, name: 'å¼ºå¿ƒè„', conditionDesc: 'Sanå€¼æ›¾=1 ä½†æ²¡æ­»', description: 'å¦‚æœä½ æ­»ä¸äº†ï¼Œå°±ä¼šå˜å¾—æ›´å¼ºã€‚', rewardDesc: 'Sanå€¼å½’é›¶çš„å®¹é”™ç‡å¢åŠ  (å¤æ´»ç”²)' },
            { id: 'ACH_13', category: 'D', tier: 2, name: 'éé…‹ä¹‹ç‹', conditionDesc: 'è¿ç»­ 3 æ¬¡äº§å‡ºå¤±è´¥/Low', description: 'æœ‰äº›äººçš„è¿æ°”æ˜¯ç„å­¦ï¼Œè€Œä½ çš„æ˜¯ç§‘å­¦ã€‚', rewardDesc: 'ä¸‹ä¸€æ¬¡å¿…å®šè§¦å‘ High äº‹ä»¶' },
            { id: 'ACH_14', category: 'D', tier: 3, name: 'çˆ¬å¢™ä¸“ä¸šæˆ·', conditionDesc: 'è§¦å‘â€œçˆ¬å¢™â€ç»“å±€', description: 'æ‹œæ‹œå°±æ‹œæ‹œï¼Œä¸‹ä¸€ä¸ªæ›´ä¹–ã€‚', rewardDesc: '(è¿™æ˜¯ç»“å±€æˆå°±ï¼Œæ— Buff)' },
        ];

        const RANDOM_EVENTS = [
            {
                id: 'EVT_SERVER_DOWN',
                name: 'å¿«ä¹è€å®¶ç‚¸äº†',
                description: 'çªå‘ï¼Lofter/AO3 æœåŠ¡å™¨è¢«ä¸æ˜åŠ›é‡å‡»ä¸­ï¼ˆå´©äº†ï¼‰ã€‚ä½ çš„â€œå¿«ä¹è€å®¶â€ç‚¸äº†ï¼Œå…¨ç½‘åŒäººå¥³æˆ’æ–­ååº”å‘ä½œï¼Œå“€é¸¿éé‡ã€‚',
                effectDesc: 'San -20 (ç„¦è™‘) | æœ¬å‘¨å¼ºåˆ¶è·³è¿‡',
                logic: { san: -20, skipTurn: true }
            },
            {
                id: 'EVT_BACKSTAB',
                name: 'å®˜æ–¹åƒä¹¦èƒŒåˆº',
                description: 'å®˜æ–¹çªç„¶åƒä¹¦æ”¹è®¾å®šï¼ä½ æäº†ä¸‰å¹´çš„ CP å±…ç„¶è¢«å®˜æ–¹ç›–ç« æ˜¯â€œå¤±æ•£å¤šå¹´çš„äº²å…„å¦¹/ä»‡äººâ€ã€‚ä½ çš„ç²®ä»“å¡Œäº†ä¸€åŠï¼Œå°ä¸‘ç«Ÿæ˜¯æˆ‘è‡ªå·±ã€‚',
                effectDesc: 'San -30 (å¿ƒæ¢—) | Toxic +15 (å› çˆ±ç”Ÿæ¨)',
                logic: { san: -30, toxic: 15 }
            },
            {
                id: 'EVT_REALITY',
                name: 'ä¸‰æ¬¡å…ƒçš„é“æ‹³',
                description: 'ç°å……ç”Ÿæ´»ç»™äº†ä½ ä¸€è®°é‡æ‹³ï¼ˆçªç„¶è¢«æŠ“å»ç›¸äº²/è€æ¿å¤ºå‘½è¿ç¯Callï¼‰ã€‚ä½ è¢«è¿«æš‚æ—¶æ”¾ä¸‹â€œèµ›åšå¥³æ˜æ˜Ÿâ€çš„èº«ä»½ï¼Œå»ä¿®è¡¥æ‘‡æ‘‡æ¬²å çš„ç°å®ç”Ÿæ´»ã€‚',
                effectDesc: 'AP æ¸…é›¶ (æ— æ³•è¡ŒåŠ¨) | Money +200 (çªå›Šè´¹)',
                logic: { apZero: true, money: 200 }
            },
            {
                id: 'EVT_SCANDAL',
                name: 'æ­£ä¸»è¸©ç¼çº«æœº',
                description: 'æƒŠå¤©å¤§ç“œï¼ä½ æçš„çº¸ç‰‡äºº/çš®å¥—äºº/æ­£ä¸»å±…ç„¶æ³•åˆ¶å’–äº†/å¡Œæˆ¿äº†ï¼è¶…è¯è¿å¤œè§£æ•£ï¼Œä½ çš„ä¸»é¡µå˜æˆäº†å¤§å‹èµ›åšçµå ‚ã€‚',
                effectDesc: 'San -50 (å´©å¡Œ) | çƒ­åº¦ -5000 (è„±ç²‰) | âš ï¸ è­¦å‘Šï¼šä¸‹å‘¨å¤§æ¦‚ç‡é€€ç½‘',
                logic: { san: -50, heat: -5000, triggerFlag: 'scandal_active' }
            },
            {
                id: 'EVT_SHADOWBAN',
                name: 'é™æµå¤§ç¤¼åŒ…',
                description: 'ä¸çŸ¥é“è§¦å‘äº†ä»€ä¹ˆå…³é”®è¯ï¼Œä½ çš„è´¦å·è¢«å¤§çœ¼ä»”/å¹³å°é™æµäº†ã€‚å‘å‡ºå»çš„å›¾åªæœ‰ä½ è‡ªå·±èƒ½çœ‹è§ï¼Œä»¿ä½›åœ¨è¿™ä¸ªäº’è”ç½‘ä¸Šè£¸å¥”ã€‚',
                effectDesc: 'San -10 | çƒ­åº¦å¢é•¿å½’é›¶ (æŒç»­2å‘¨)',
                logic: { san: -10, buff: 'shadow_ban', buffDuration: 2 }
            }
        ];

        const ACTIONS = {
            writer: [
                { id: 'lv1', label: 'æ¡æ‰‹æœºè®°è„‘æ´', apCost: 1, baseSanChange: 0, baseMoneyChange: 0, intent: 'å‡Œæ™¨ä¸‰ç‚¹çš„çµå…‰ä¸€é—ªï¼Œæ„Ÿè§‰è‡ªå·±å°±æ˜¯èå£«æ¯”äºšè½¬ä¸–ã€‚' },
                { id: 'lv2', label: 'çŸ­ç¯‡ä¸€å‘å®Œ', apCost: 2, baseSanChange: -10, baseMoneyChange: 0, baseHeat: 200, intent: 'é€»è¾‘æ˜¯ä»€ä¹ˆï¼Œæˆ‘åªæƒ³æç‘Ÿæƒ…ï¼' },
                { id: 'lv3', label: 'é•¿ç¯‡è¿è½½', apCost: 3, baseSanChange: -30, baseMoneyChange: 0, baseHeat: 800, intent: 'è¿™æ˜¯ä¸€ä¸ªå®å¤§çš„ä¸–ç•Œè§‚ï¼Œè¿™æ˜¯ä¸€åœºæ¼«é•¿çš„é©¬æ‹‰æ¾â€¦â€¦' }
            ],
            artist: [
                { id: 'lv1', label: 'æ‘¸é±¼QQäºº', apCost: 1, baseSanChange: 5, baseMoneyChange: 0, baseHeat: 200, intent: 'ä¸æƒ³æ‰£é€è§†ï¼Œä¸æƒ³ç”»èƒŒæ™¯ï¼Œåªæƒ³ç”»ç³¯ç±³å›¢å­è´´è´´ã€‚' },
                { id: 'lv2', label: 'å®Œæ•´å…¨èº«å›¾', apCost: 2, baseSanChange: -15, baseMoneyChange: 0, baseHeat: 500, intent: 'è¿™ä¸€æ¬¡ï¼Œæˆ‘è¦æŒ‘æˆ˜é‚£ä¸ªåäººç±»çš„äººä½“ç»“æ„å’Œç»ç¾çš„å…‰å½±ã€‚' },
                { id: 'lv3', label: 'å…¨å‘˜ç¾¤åƒ', apCost: 3, baseSanChange: -40, baseMoneyChange: 0, baseHeat: 1000, intent: 'ç‡ƒçƒ§ç”Ÿå‘½ï¼ŒæŒ‘æˆ˜æé™ã€‚PSå·²ç»æœªå“åº”ä¸‰æ¬¡äº†ï¼' }
            ],
            editor: [
                { id: 'lv1', label: 'å­˜BGM/ç”»å¤§é¥¼', apCost: 1, baseSanChange: 5, baseMoneyChange: 0, intent: 'è¿™é¦–æ­Œç®€ç›´æ˜¯ä¸ºæˆ‘CPé‡èº«å®šåšçš„ï¼å…ˆå»ºä¸ªåä¸ºâ€œç»ä¸–å¤§ç‰‡â€çš„ç©ºæ–‡ä»¶å¤¹ã€‚' },
                { id: 'lv2', label: 'å¡ç‚¹/å¥—æ¨¡æ¿', apCost: 2, baseSanChange: -10, baseMoneyChange: 0, baseHeat: 300, intent: 'åªè¦é¼“ç‚¹è¸©å¾—å¥½ï¼Œæ‹‰éƒä¹Ÿèƒ½å˜å®˜é…ã€‚' },
                { id: 'lv3', label: 'ç‰¹æ•ˆå¤§ç‰‡', apCost: 3, baseSanChange: -35, baseMoneyChange: 0, baseHeat: 900, intent: 'ç”¨åŸå‰§çš„è¾¹è§’æ–™ï¼Œæ‹¼å‡‘å‡ºä¸€ä¸ªåŸæœ¬ä¸å­˜åœ¨çš„BEç¾å­¦ã€‚' }
            ],
            passerby: [
                { id: 'lv1', label: 'åº“åº“åƒç²®', apCost: 1, baseSanChange: 10, baseMoneyChange: 0, intent: 'æ‹¿ç€ç ´ç¢—å®ˆåœ¨å¤§å¤§é—¨å£ï¼šå¥³ç¥ã€é¥­é¥­ã€é¥¿é¥¿ã€‚' },
                { id: 'lv2', label: 'é’èƒ½åŠ›çº¦ç¨¿', apCost: 2, baseSanChange: 20, baseMoneyChange: -500, intent: 'æ—¢ç„¶æ²¡äººäº§æˆ‘çˆ±åƒçš„ç²®ï¼Œé‚£æˆ‘å°±ç”¨é’±ç ¸å‡ºä¸€ä¸ªæœªæ¥ã€‚' },
                { id: 'lv3', label: 'äº§ç²®(ä¼ª)', apCost: 3, baseSanChange: -5, baseMoneyChange: 0, baseHeat: 50, intent: 'è™½ç„¶æˆ‘æ˜¯è·¯äººï¼Œä½†æˆ‘ä¹Ÿè¦ä¸ºCPå‘å…‰å‘çƒ­ï¼' }
            ],
            SOCIAL: [
                { id: 'lv1', label: 'ç§¯æç¤¾äº¤', apCost: 1, baseSanChange: 5, baseMoneyChange: 0, intent: 'æ‡’å¾—æ‰“å­—ï¼Œåªæƒ³ç”¨ä¸€ä¸²â€œå•Šå•Šå•Šå•Šâ€æ¥è¡¨è¾¾å¯¹è¿™ä¸ªä¸–ç•Œçš„æ•¬æ„ã€‚' },
                { id: 'lv2', label: 'å®‰åˆ©/æ‰©åˆ—', apCost: 2, baseSanChange: 0, baseMoneyChange: 0, baseHeat: 100, intent: 'åªæœ‰æ‰¾åˆ°ç»„ç»‡ï¼Œæˆ‘çš„CPè„‘æ‰ä¸ä¼šåœ¨è¿™ä¸ªå†·æ¼ çš„ä¸–ç•Œé‡Œæ„Ÿåˆ°å­¤ç‹¬ã€‚' },
                { id: 'lv3', label: 'æˆ˜æ–—å¯¹çº¿', apCost: 2, baseSanChange: -20, baseMoneyChange: 0, baseHeat: 500, intent: 'è°æ•¢æ‹†æˆ‘CPï¼Ÿè°æ•¢å˜´æˆ‘æ‹…ï¼Ÿé”®æ¥ï¼' }
            ],
            LIFE: [
                { id: 'lv1', label: 'ç¡å¤§è§‰/èººå¹³', apCost: 1, baseSanChange: 15, baseMoneyChange: 0, intent: 'åªè¦æˆ‘ç¡å¾—å¤Ÿå¿«ï¼Œç”Ÿæ´»çš„çƒ¦æ¼å°±è¿½ä¸ä¸Šæˆ‘ã€‚' },
                { id: 'lv2', label: 'æ¬ç –æ‰“å·¥', apCost: 2, baseSanChange: -10, baseMoneyChange: 800, intent: 'ä¸ºäº†ä¹°è°·å­ï¼Œä¸ºäº†ç»™çˆ±å‘ç”µï¼Œè‚‰ä½“åœ¨åç‰¢ï¼Œçµé­‚æåŒäººã€‚' },
                { id: 'lv3', label: 'ç°å……èšä¼š', apCost: 3, baseSanChange: 5, baseMoneyChange: -200, intent: 'æˆ´ä¸Šåä¸ºâ€œç°å……â€çš„é¢å…·ï¼Œå°å¿ƒä¸è¦æŠŠç›¸å†Œé‡Œçš„æ¶©å›¾éœ²å‡ºæ¥ã€‚' }
            ]
        };

        const FLAVOR_TEXT = {
            writer: {
                lv1: {
                    high: [
                        "éšæ‰‹å†™çš„æ¢—å±…ç„¶ç«äº†ï¼Œçƒ­åº¦æ¶¨å¾—æ¯”ä½ æ­£ç»å†™çš„è¿è½½è¿˜å¿«ï¼Œå¿ƒæƒ…å¤æ‚ä½†å¿«ä¹ã€‚",
                        "åšæ¢¦éƒ½æ¢¦åˆ°äº†ç»ç¾è„‘æ´ï¼Œé†’æ¥ç«‹åˆ»è®°åœ¨å¤‡å¿˜å½•é‡Œï¼Œæ„Ÿè§‰è¿™æœ¬å¿…ç«ã€‚",
                        "å†™äº†ä¸€è¾†ç¢°ç¢°è½¦ï¼Œè™½ç„¶æ²¡ä¸Šé«˜é€Ÿï¼Œä½†è‡ªå·±åœ¨è¢«çªé‡Œç¬‘å‡ºäº†å£°ã€‚"
                    ],
                    normal: [
                        "æŸ¥èµ„æ–™æŸ¥äº†ä¸‰ä¸ªå°æ—¶ï¼Œç”šè‡³å­¦ä¼šäº†ç»´å¤šåˆ©äºšæ—¶æœŸçš„é¤æ¡Œç¤¼ä»ªï¼Œæ­£æ–‡ä¸€ä¸ªå­—æ²¡åŠ¨ã€‚",
                        "æ‰“å¼€æ–‡æ¡£ï¼Œåˆ·å¾®åšï¼Œåˆ·Bç«™ï¼Œåˆ·æ·˜å®ï¼Œå…³æ‰æ–‡æ¡£ã€‚å®Œç¾çš„ä¸€å¤©ã€‚",
                        "ä¸ºäº†æé»„ï¼Œä½ æŸ¥é˜…äº†äººä½“è§£å‰–å­¦å›¾è°±ï¼Œæ„Ÿè§‰è‡ªå·±åƒä¸ªä¸¥è°¨çš„æ³•åŒ»ã€‚"
                    ],
                    low: [
                        "å†™äº†ä¸€ä¸‡å­—çš„å¤§çº²ï¼Œç¡ä¸€è§‰é†’æ¥è§‰å¾—å…¨æ˜¯åƒåœ¾ï¼Œç›´æ¥æ‹–è¿›å›æ”¶ç«™ã€‚",
                        "å› ä¸ºé•¿æœŸä¹…åç å­—ï¼Œè…°é—´ç›˜çªå‡ºçŠ¯äº†ï¼Œåªèƒ½èººåœ¨åºŠä¸Šæ„æ€ã€‚",
                        "å†™åˆ°ä¸€åŠç”µè„‘è“å±ï¼Œæ–‡æ¡£æ²¡ä¿å­˜ï¼Œå½“åœºå¿ƒæ¢—ã€‚"
                    ]
                },
                lv2: {
                    high: [
                        "çµæ„Ÿçˆ†å‘ï¼Œæ—¶é€Ÿä¸‰åƒï¼Œä½ æ„Ÿè§‰é”®ç›˜éƒ½è¦å†’ç«æ˜Ÿå­äº†ï¼Œä½ æ˜¯ç å­—çš„ç¥ï¼",
                        "å†™åˆ°äº†ä¸¤ä¸ªäººçš„ç»ç¾åºŠæˆï¼Œä½ è‡ªå·±å¯¹ç€å±å¹•è„¸çº¢å¿ƒè·³ï¼Œæ„Ÿè§‰è‡ªå·±åœ¨é€ ç¦äººç±»ã€‚",
                        "æ”¶åˆ°äº†ä¸€åƒå­—çš„å°è®ºæ–‡é•¿è¯„ï¼Œä½ åå¤è¯»äº†åéï¼Œç”šè‡³æƒ³æ‰“å°å‡ºæ¥è£±åœ¨å¢™ä¸Šã€‚"
                    ],
                    normal: [
                        "ä»Šå¤©åªå†™äº†ä¸‰ç™¾å­—ï¼Œä»¥æ­¤æ…°è—‰è‡ªå·±ï¼šå¥½æ­¹æ²¡æ–­æ›´ã€‚",
                        "æ­£åœ¨å†™è™æ¢—ï¼Œå¬ç€æ‚²ä¼¤çš„ BGMï¼ŒæŠŠè‡ªå·±å†™å“­äº†ï¼Œå»æ´—äº†æŠŠè„¸ã€‚",
                        "å“ªæ€•æ˜¯æ¸…æ°´æ–‡ï¼Œä½ ä¹Ÿåœ¨æƒ³è¦ä¸è¦æ‰“ä¸ª tag éª—ç‚¹ç‚¹å‡»ç‡ï¼Œæœ€åè¿˜æ˜¯æ”¾å¼ƒäº†ã€‚"
                    ],
                    low: [
                        "è¢«æ ç²¾è¿½ç€éª‚äº†åæ¡è¯„è®ºï¼Œè¯´ä½ äººè®¾å´©åï¼Œä½ æ°”å¾—æ‰‹æŠ–ï¼Œæ‰“å­—éƒ½æ‰“ä¸åˆ©ç´¢ã€‚",
                        "å‘ç°è‡ªå·±çš„æ–‡è¢«ç›—æ–‡ç½‘æ¬è¿äº†ï¼Œç”šè‡³è¿ä½œè€…åéƒ½æ”¹æˆäº†â€œä½šåâ€ã€‚",
                        "ç”šè‡³æŠŠæ”»å—çš„åå­—å†™åäº†ï¼Œå‘å‡ºå»åŠå°æ—¶æ‰å‘ç°ï¼Œç¤¾æ­»ç°åœºã€‚"
                    ]
                },
                lv3: {
                    high: [
                        "ç»ˆäºå¡«å¹³äº†é‚£ä¸ªå‘äº†ä¸¤å¹´çš„å¤§å‘ï¼Œè¯„è®ºåŒºéƒ½åœ¨è¿‡å¹´æ”¾é­ç‚®ã€‚",
                        "è¿è½½æ–‡ä¸Šäº†é¦–é¡µæ¨èï¼ˆå°½ç®¡æ˜¯å†·é—¨åŒºï¼‰ï¼Œæ¶¨ç²‰é€Ÿåº¦è®©ä½ æ€€ç–‘æ˜¯ä¸æ˜¯ä¹°äº†åƒµå°¸ç²‰ã€‚",
                        "è¿™é‡Œçš„å‰§æƒ…é€»è¾‘åœ†å¾—å¤ªå®Œç¾äº†ï¼Œä¼ç¬”å›æ”¶çš„é‚£ä¸€åˆ»ï¼Œä½ è§‰å¾—è‡ªå·±æ˜¯è¯ºå…°ã€‚"
                    ],
                    normal: [
                        "å¡æ–‡å¡åœ¨ç¬¬ä¸€å¥ï¼Œä¸ºäº†é€ƒé¿ç å­—ï¼Œä½ ç”šè‡³æŠŠé”®ç›˜ç¼éš™éƒ½æ“¦å¾—å¹²å¹²å‡€å‡€ã€‚",
                        "è¯•å›¾ä¿®æ–‡ï¼Œç»“æœæ”¹æ¥æ”¹å»è¿˜æ˜¯è§‰å¾—ç¬¬ä¸€ç‰ˆæœ€å¥½ï¼Œç™½å¿™æ´»ä¸€åœºã€‚",
                        "åœ¨è¿™ä¸ªå†·åœˆï¼Œä½ å€”å¼ºåœ°å‰²ç€è…¿è‚‰ï¼Œå«æ³ªè‡ªå·±åƒï¼Œå‘³é“ç«Ÿç„¶è¿˜ä¸é”™ã€‚"
                    ],
                    low: [
                        "å‚åŠ å¾æ–‡æ¯”èµ›ï¼Œç»“æœè¿å…¥å›´éƒ½æ²¡æœ‰ï¼Œçœ‹ç€ç¬¬ä¸€åçš„æ³¨æ°´æ–‡é™·å…¥æ²‰æ€ã€‚",
                        "ç”šè‡³å› ä¸ºå†™å¾—å¤ªæ…¢ï¼Œè¢«è¯»è€…æ€€ç–‘å·²ç»é€€åœˆ/è·‘è·¯äº†ã€‚",
                        "æ— è®ºæ€ä¹ˆå†™éƒ½è§‰å¾—è‡ªå·±åœ¨ OOCï¼Œé™·å…¥äº†æ·±æ·±çš„è‡ªæˆ‘æ€€ç–‘ã€‚"
                    ]
                }
            },
            artist: {
                lv1: {
                    high: [
                        "éšæ‰‹ç”»çš„ç«æŸ´äººæ¢—å›¾å±…ç„¶è¢«å¤§Vè½¬äº†ï¼Œå…¨ç½‘éƒ½åœ¨ç”¨ä½ çš„è¡¨æƒ…åŒ…ã€‚",
                        "ç”šè‡³ä¸ç”¨æ¶²åŒ–ï¼Œå‹å‡†å¾—å¯æ€•ï¼Œä»Šå¤©çš„ä½ æ‰‹æ„Ÿç«çƒ­å¾—èƒ½ç…è›‹ã€‚",
                        "æ‘¸é±¼æ‘¸äº†ä¸€å¼ å¤§å¤´ï¼Œè§‰å¾—è¿˜æ˜¯è‰ç¨¿æµæœ€å¿«ä¹ï¼Œç»†åŒ–ï¼Ÿä¸å­˜åœ¨çš„ã€‚"
                    ],
                    normal: [
                        "ç”»ä¸¤åªçœ¼ç›ç”»å¾—ä¸å¯¹ç§°ï¼Œæ”¹äº†ä¸€ä¸‹åˆï¼Œæœ€åå†³å®šç»™ä¸€åªçœ¼ç”»ä¸Šçœ¼ç½©/åˆ˜æµ·ã€‚",
                        "ç¬”åˆ·æ‰¾äº†åŠå°æ—¶ï¼Œç”»ç”»äº”åˆ†é’Ÿï¼Œè¿™å°±æ˜¯ç”»æ‰‹çš„æ—¥å¸¸ã€‚",
                        "å¯¹ç€é•œå­åšé¬¼è„¸æ¥ç ”ç©¶è¡¨æƒ…ï¼Œè·¯è¿‡çš„å®¶äººè§‰å¾—ä½ ç–¯äº†ã€‚"
                    ],
                    low: [
                        "ç”šè‡³åœ¨æ•°ä½æ¿ä¸Šè´´äº†æ–°çš„è†œï¼Œè¯•å›¾å¯»æ‰¾â€œçº¸ä¸Šä½œç”»â€çš„é”™è§‰ã€‚",
                        "æœ‹å‹é—®ä½ èƒ½ç”»ä¸ªå¤´åƒå—ï¼Œä½ è¯´â€œæ”¶è´¹500â€ï¼Œæœ‹å‹ç«‹åˆ»é—­å˜´äº†ã€‚",
                        "ç”šè‡³ä¸€è¾¹çœ‹å‰§ä¸€è¾¹ç”»ç”»ï¼Œæœ€åå‰§çœ‹å®Œäº†ï¼Œç”»è¿˜åœ¨ç¬¬ä¸€ç¬”ã€‚"
                    ]
                },
                lv2: {
                    high: [
                        "å°è¯•äº†æ–°çš„åšæ¶‚ç”»æ³•ï¼Œæ•ˆæœå‡ºå¥‡çš„å¥½ï¼Œæ„Ÿè§‰æ‰“å¼€äº†æ–°ä¸–ç•Œçš„å¤§é—¨ã€‚",
                        "è¢«å†™æ‰‹å¤ªå¤ªæ‹¿å»åšäº†å°é¢ï¼Œå¹¶åœ¨è¿™ä¸ªåœˆå­çš„å¿…è¯»åˆ—è¡¨é‡Œç•™ä¸‹äº†ä½ çš„åå­—ã€‚",
                        "ç”»å®Œä¹‹åï¼Œæ­£å¥½èµ¶ä¸Šå®˜æ–¹å‘ç³–ï¼Œä½ çš„å›¾æˆäº†ç»ä½³çš„é¥­åç”œç‚¹ï¼Œçƒ­åº¦èµ·é£ã€‚"
                    ],
                    normal: [
                        "æ¯æ¬¡ç”»å®Œçº¿ç¨¿è§‰å¾—æ˜¯ç¥ä½œï¼Œä¸Šå®Œè‰²è§‰å¾—æ˜¯ä¸€å¨ï¼Œé»˜é»˜ç‚¹äº†æ’¤é”€ã€‚",
                        "ä¸ºäº†æ‰¾ä¸€ä¸ªåˆé€‚çš„å§¿åŠ¿å‚è€ƒï¼Œåœ¨ Pinterest ä¸Šé€›äº†ä¸¤å°æ—¶ã€‚",
                        "ç”»äº†ä¸€å¼ å¾ˆæ»¡æ„çš„è‰å›¾ï¼Œç„¶åæ–°å»ºå›¾å±‚æçº¿ï¼Œå‘ç°çµé­‚æ²¡äº†ã€‚"
                    ],
                    low: [
                        "ç”µè„‘è‰²å·®å®³æ­»äººï¼Œåœ¨ç”µè„‘ä¸Šçœ‹å¥½å¥½çš„ï¼Œä¼ åˆ°æ‰‹æœºä¸Šç°å¾—åƒé—åƒã€‚",
                        "é•¿æœŸæ¡ç¬”å¯¼è‡´è…±é˜ç‚å‘ä½œï¼Œæ‰‹è…•ç–¼å¾—åƒæ–­äº†ä¸€æ ·ï¼Œè¢«è¿«å°ç¬”å…»ä¼¤ã€‚",
                        "ç”»é£çªå˜è¢«è€ç²‰è¯´â€œé€€æ­¥äº†â€æˆ–è€…â€œæ¢äººäº†â€ï¼Œä½ å§”å±ˆå¾—æƒ³å“­ã€‚"
                    ]
                },
                lv3: {
                    high: [
                        "ç›´æ’­ç”»ç”»çš„æ—¶å€™ï¼Œå›´è§‚äººæ•°ç ´çºªå½•ï¼Œå¤§å®¶éƒ½åœ¨åˆ·â€œè§¦æ‰‹çŒ®ç¥­â€ã€‚",
                        "å‚åŠ å®˜æ–¹çš„ç»˜ç”»æ¯”èµ›ï¼Œå±…ç„¶æ‹¿äº†å¥–ï¼Œå¥–å“æ˜¯å…¨å¥—å‘¨è¾¹å’Œå¥–é‡‘ï¼",
                        "ç”šè‡³ç”»å‡ºäº†ç¥ä»™å…‰å½±ï¼Œè¿™æ°›å›´æ„Ÿç»äº†ï¼Œä½ è‡ªå·±éƒ½èˆä¸å¾—åŠ æ°´å°ã€‚"
                    ],
                    normal: [
                        "ä¸Šè‰²ä¸Šåˆ°ä¸€åŠè§‰å¾—è„äº†ï¼Œé»˜é»˜å…³æ‰å›¾å±‚çœ¼ç›ï¼Œå‡è£…ä»€ä¹ˆéƒ½æ²¡å‘ç”Ÿã€‚",
                        "è¯•å›¾ç”»æ‰‹ï¼Œç»“æœç”»æˆäº†é¸¡çˆªï¼Œç”šè‡³æŠŠè‡ªå·±çš„æ‰‹æ‘†åœ¨å±å¹•å‰æ¯”åˆ’åˆ°æŠ½ç­‹ã€‚",
                        "åœ¨è¿™ä¸ªå†·åœˆï¼Œä½ å€”å¼ºåœ°å‰²ç€è…¿è‚‰ï¼Œè‡ªç»™è‡ªè¶³ï¼Œè™½ç„¶éš¾åƒä½†ç®¡é¥±ã€‚"
                    ],
                    low: [
                        "ç”šè‡³ç”»äº†åä¸ªå°æ—¶ï¼Œç»“æœçƒ­åº¦è¿˜ä¸å¦‚éšä¾¿æ¶‚çš„ç«æŸ´äººã€‚",
                        "è½¯ä»¶å´©æºƒï¼Œè‡ªåŠ¨ä¿å­˜çš„æ–‡ä»¶ä¹Ÿæ˜¯æŸåçš„ï¼Œä½ çš„ä¸€å¤©ç™½å¹²äº†ã€‚",
                        "æœ‰äººåœ¨ä½ çš„å›¾ä¸‹é¢åˆ·CPé€†å®¶çš„å£å·ï¼Œåƒåƒäº†è‹è‡ä¸€æ ·æ¶å¿ƒã€‚"
                    ]
                }
            },
            editor: {
                lv1: {
                    high: [
                        "å‰ªè¾‘æ€è·¯å¦‚æ³‰æ¶Œï¼Œä¸¤ä¸ªå°æ—¶å°±å‰ªå®Œäº†ä¸€ä¸ªçŸ­ç‰‡ï¼Œæ•ˆç‡çˆ†ç‚¸ã€‚",
                        "ç”šè‡³æœ‰äººç§ä¿¡é—®ä½ æ¥ä¸æ¥å•†å•ï¼Œä»·æ ¼å¼€å¾—å¾ˆè¯±äººã€‚",
                        "æ‰¾åˆ°äº†ä¸€ä¸ªç»é…çš„ç©ºé•œç´ æï¼ŒæŠŠæ°›å›´æ„Ÿæ‹‰æ»¡ï¼Œä½ è‡ªå·±éƒ½çœ‹å“­äº†ã€‚"
                    ],
                    normal: [
                        "æ–°å»ºæ–‡ä»¶å¤¹ï¼šâ€˜æœ€ç»ˆç‰ˆâ€™ã€â€˜æœ€ç»ˆç‰ˆä¸æ”¹äº†â€™ã€â€˜æ‰“æ­»ä¸æ”¹ç‰ˆâ€™ã€â€˜å†æ”¹æˆ‘æ˜¯ç‹—â€™ã€‚",
                        "ç”šè‡³ä¸ºäº†æ‰¾ä¸€ä¸ªåˆé€‚çš„è½¬åœºéŸ³æ•ˆï¼ŒæŠŠå¤–ç½‘çš„ç´ æåº“ç¿»äº†ä¸ªåº•æœå¤©ã€‚",
                        "åœ¨æ—¶é—´è½´ä¸Šå¾®è°ƒ 0.01 ç§’ï¼Œå¼ºè¿«ç—‡å‘ä½œï¼Œè§‰å¾—æ€ä¹ˆçœ‹éƒ½ä¸å¯¹åŠ²ã€‚"
                    ],
                    low: [
                        "BGM å› ä¸ºç‰ˆæƒè¢«æ›¿æ¢æˆäº†å¥‡æ€ªçš„è½»éŸ³ä¹ï¼ŒåŸæœ¬çš„æ°”æ°›å…¨æ¯äº†ã€‚",
                        "ç”µè„‘é…ç½®å¤ªä½ï¼Œé¢„è§ˆä¸€å¡ä¸€å¡ï¼Œå‰ªè¾‘ä½“éªŒåƒåœ¨æ”¾ PPTã€‚",
                        "ç”šè‡³å¿˜äº†å…³åŸå£°ï¼ŒBGM å’Œè§’è‰²å°è¯æ··åœ¨ä¸€èµ·ï¼Œåµå¾—åƒèœå¸‚åœºã€‚"
                    ],
                },
                lv2: {
                    high: [
                        "BGM å’Œç”»é¢çš„è¸©ç‚¹ä¸æ»‘å¾—åƒå¾·èŠ™ï¼Œä½ åå¤è§‚çœ‹äº†äº”åéè‡ªå·±çš„å¤§ä½œã€‚",
                        "å°è¯æ‹¼æ¥å¾—å¤©è¡£æ— ç¼ï¼Œä»¿ä½›è§’è‰²çœŸçš„è¯´äº†è¿™å¥è¯ï¼Œè§‚ä¼—éƒ½åœ¨é—®æ˜¯å“ªä¸€é›†ã€‚",
                        "ä½ çš„è§†é¢‘æŠŠå†·é—¨CPå‰ªå‡ºäº†å¤§ç‰‡æ„Ÿï¼ŒæˆåŠŸå®‰åˆ©äº†ä¸€å¤§æ³¢æ–°äººå…¥å‘ã€‚"
                    ],
                    normal: [
                        "ä¸ºäº†å¡ä¸€ä¸ªé¼“ç‚¹ï¼Œä½ å¬è¿™é¦–æ­Œå¬äº†äº”ç™¾éï¼Œç°åœ¨å¬åˆ°å‰å¥å°±æƒ³åã€‚",
                        "è½¨é“å¤šå¾—åƒèœ˜è››ç½‘ï¼Œä½ è‡ªå·±éƒ½å¿«çœ‹ä¸æ‡‚å“ªå±‚æ˜¯å“ªå±‚äº†ã€‚",
                        "ç¡¬ç›˜çº¢äº†ï¼ˆæ»¡äº†ï¼‰ï¼Œä¸€è¾¹å¿ƒç–¼åœ°åˆ ç´ æï¼Œä¸€è¾¹æƒ³ä¹°æ–°ç¡¬ç›˜ã€‚"
                    ],
                    low: [
                        "å‰ªè§†é¢‘å‰ªåˆ°è½¯ä»¶å´©æºƒï¼Œä½ ç”šè‡³æ²¡æ¥å¾—åŠä¿å­˜ï¼Œæƒ³æŠŠç”µè„‘ç ¸äº†ã€‚",
                        "æ¸²æŸ“è¿›åº¦æ¡å¡åœ¨ 99% ä¸åŠ¨äº†ï¼Œä½ è·ªåœ¨ç”µè„‘å‰ç¥ˆç¥·ï¼Œä½†å®ƒè¿˜æ˜¯æŠ¥é”™äº†ã€‚",
                        "AE å´©æºƒäº†ä¸‰æ¬¡ï¼Œå†…å­˜æº¢å‡ºï¼Œç”µè„‘é£æ‰‡å“å¾—åƒç›´å‡æœºèµ·é£ã€‚"
                    ]
                },
                lv3: {
                    high: [
                        "ç‰¹æ•ˆåšå¾—å¤ªå¥½äº†ï¼Œè¢«è¯¯è®¤ä¸ºæ˜¯å®˜æ–¹åŸç‰‡ï¼Œè¿˜è¦å‘ç½®é¡¶è§£é‡Šæ˜¯äºŒåˆ›ã€‚",
                        "è§†é¢‘ä¸Šäº†é¦–é¡µæ¨èï¼Œå¼¹å¹•å…¨æ˜¯â€œå¼€å£è·ªâ€å’Œâ€œç¥ä»™å‰ªè¾‘â€ï¼Œæ»¡å±çš„â€œAWSLâ€ã€‚",
                        "ç”šè‡³æåˆ°äº†è¶…é«˜æ¸…çš„ 4K ç”Ÿè‚‰æºï¼Œæ¯ä¸€ä¸ªæ¯›å­”éƒ½æ¸…æ™°å¯è§ï¼Œç´ æåº“å–œåŠ ä¸€ã€‚"
                    ],
                    normal: [
                        "æ­£åœ¨è°ƒè‰²ï¼Œçœ¼ç›å·²ç»åˆ†è¾¨ä¸å‡ºçº¢è‰²å’Œæ´‹çº¢è‰²çš„åŒºåˆ«äº†ã€‚",
                        "ç”šè‡³ç”¨æ‰‹æœºå‰ªè¾‘è½¯ä»¶æ‘¸äº†ä¸ªé±¼ï¼Œç»“æœæ¯”ç”¨ PR åšçš„è¿˜æœ‰æ„Ÿè§‰ã€‚",
                        "ç”šè‡³ä¸ºäº†åšå°é¢ï¼Œåˆä¸´æ—¶å­¦ä¼šäº†åŠåŠå­çš„ PS æŠ€æœ¯ã€‚"
                    ],
                    low: [
                        "è¾›è¾›è‹¦è‹¦å‰ªäº†ä¸€å‘¨ï¼Œå‘å‡ºå»å› ä¸ºç‰ˆæƒé—®é¢˜è¢«å¹³å°é™æµ/é™éŸ³/ä¸‹æ¶ã€‚",
                        "ç”šè‡³å¯¼å‡ºåå‘ç°éŸ³ç”»ä¸åŒæ­¥ï¼Œå˜´å‹å¯¹ä¸ä¸Šï¼Œå¿ƒæ€å½»åº•å´©äº†ã€‚",
                        "å‰ªå‰§æƒ…å‘å¤§ç‰‡å› ä¸ºå¤ªè™ï¼Œå¤§å®¶éƒ½ä¸æ•¢ç‚¹å¼€ï¼Œæ’­æ”¾é‡å¡åœ¨ 200ã€‚"
                    ]
                }
            },
            SOCIAL: {
                lv1: {
                    high: [
                        "ä½ çš„è¯„è®ºè¢«å¤ªå¤ªç½®é¡¶äº†ï¼Œç¬é—´æ¶¨äº†å‡ ç™¾ä¸ªèµï¼Œæ„Ÿè§‰äººç”Ÿåˆ°è¾¾äº†å·…å³°ã€‚",
                        "ç”šè‡³è¢«ä½œè€…ç¿»ç‰Œå›å¤äº†â€œè´´è´´â€ï¼Œä½ å¯¹ç€å±å¹•å‚»ç¬‘äº†åŠå°æ—¶ã€‚",
                        "éšæ‰‹å‘çš„ä¸€å¥â€œå¥½ç»â€æˆäº†çƒ­è¯„ç¬¬ä¸€ï¼Œå¤§å®¶éƒ½åœ¨æ’é˜ŸæŠ„ä½ çš„ä½œä¸šã€‚"
                    ],
                    normal: [
                        "æƒ³éªšè¯æƒ³äº†åŠå¤©ï¼Œæ€•è¢«å±è”½ï¼Œæœ€ååˆ åˆ å‡å‡å‘äº†ä¸ªè¡¨æƒ…ã€‚",
                        "åœ¨è¯„è®ºåŒºçœ‹å¤§å®¶èŠå¤©ï¼Œæ„Ÿè§‰è‡ªå·±åƒä¸ªè·¯è¿‡çš„ç“œçŒ¹ã€‚",
                        "çœ‹åˆ°å¤§å®¶éƒ½åœ¨å¤¸ï¼Œä½ å¤åˆ¶ç²˜è´´äº†ä¸€å¥â€œä¿ºä¹Ÿä¸€æ ·â€ã€‚"
                    ],
                    low: [
                        "ç”šè‡³å‘é”™è¡¨æƒ…åŒ…ï¼Œå‘äº†ä¸ªå¾®ç¬‘ï¼ˆå˜²è®½è„¸ï¼‰ç»™å¤ªå¤ªï¼Œç¤¾æ­»ã€‚",
                        "ä½ çš„è¯„è®ºè¢«è¯¯åˆ¤ä¸ºåƒåœ¾å¹¿å‘ŠæŠ˜å äº†ï¼Œç”³è¯‰æ— é—¨ã€‚",
                        "ç”šè‡³è¢«æ ç²¾å›å¤äº†â€œå°±è¿™ï¼Ÿâ€ï¼Œä½ æ°”å¾—æ‰‹æŠ–ã€‚"
                    ],
                },
                lv2: {
                    high: [
                        "å®Œç¾å®‰åˆ©äº†ç°å……æœ‹å‹å…¥å‘ï¼Œçœ‹ç€å¥¹æ¯”ä½ è¿˜ä¸Šå¤´ï¼Œä½ å¾ˆæœ‰æˆå°±æ„Ÿã€‚",
                        "åŠ å…¥äº†ä¸€ä¸ªç¥ä»™ç¾¤ï¼Œé‡Œé¢å…¨æ˜¯äº§ç²®å¤§ä½¬ï¼Œæ¯å¤©éƒ½æœ‰å…è´¹é¥­åƒã€‚",
                        "ä½ å‰ªçš„å®‰åˆ©è§†é¢‘/å†™çš„å®‰åˆ©æ–‡ç«äº†ï¼Œä¸ºåœˆå­å¼•æµäº†æ— æ•°æ–°äººã€‚"
                    ],
                    normal: [
                        "ç¾¤é‡Œåœ¨èŠä½ ä¸æ‡‚çš„è¯é¢˜ï¼Œä½ åªèƒ½å‘ä¸ªâ€œå—¯å—¯â€é™„å’Œã€‚",
                        "æ¯å¤©çš„æ—¥å¸¸å°±æ˜¯åœ¨ç¾¤é‡Œå‘â€œæ—©å®‰â€å’Œâ€œæ™šå®‰â€ã€‚",
                        "å’Œäº²å‹åæ§½å·¥ä½œï¼Œç»“æœå˜æˆäº†æ¯”æƒ¨å¤§ä¼šã€‚"
                    ],
                    low: [
                        "è¿›ç¾¤ç¬¬ä¸€å¤©å› ä¸ºä¸æ‡‚é»‘è¯è¢«è¸¢äº†ï¼Œç”šè‡³ä¸çŸ¥é“åšé”™äº†ä»€ä¹ˆã€‚",
                        "å‘ç°æœ€å¥½çš„äº²å‹çªç„¶æŠŠä½ åˆ äº†ï¼Œæ²¡æœ‰ä»»ä½•è§£é‡Šï¼Œä½ emoäº†ã€‚",
                        "åœ¨ç¾¤é‡Œå‘é”™äº†å›¾ï¼ŒæŠŠé»„å›¾å‘åˆ°äº†æ­£ç»ç¾¤ï¼Œå…‰é€Ÿæ’¤å›è¿˜æ˜¯è¢«äººçœ‹è§äº†ã€‚"
                    ]
                },
                lv3: {
                    high: [
                        "ä¸ºäº†ç»´æŠ¤æ­£ä¸»ï¼Œä½ å†™äº†ä¸‰åƒå­—çš„å°è®ºæ–‡å›æ€¼é»‘å­ï¼Œé€»è¾‘æ»¡åˆ†ï¼Œé»‘å­å“‘å£æ— è¨€ã€‚",
                        "ä½ æŒ‚äº†é‚£ä¸ªé€†å®¶/æå“ï¼Œç”šè‡³æ¶¨äº† 1000 ä¸ªè…¿æ¯›ï¼ˆç²‰ä¸ï¼‰ï¼Œä¸€æˆ˜æˆåã€‚",
                        "å¯¹æ–¹è¢«ä½ éª‚å¾—ç ´é˜²äº†ï¼Œç”šè‡³æ³¨é”€äº†è´¦å·é€€ç½‘ï¼Œä½ å¤§è·å…¨èƒœã€‚"
                    ],
                    normal: [
                        "ä¸¾æŠ¥äº†åä¸ªé»‘å¸–ï¼Œç³»ç»Ÿåé¦ˆâ€œå¤„ç†ä¸­â€ï¼Œä½ åªèƒ½ç­‰å¾…ã€‚",
                        "åœ¨å¹¿åœºä¸Šå·¡é€»ï¼Œçœ‹åˆ°æ²¡è¥å…»çš„åµæ¶é»˜é»˜åˆ’è¿‡ã€‚",
                        "çœ‹åˆ°æœ‰äººæŒ‚äººï¼Œç‚¹è¿›å»å‘ç°æŒ‚çš„æ˜¯ä¸ªå°å·ï¼Œæ²¡æ„æ€ã€‚"
                    ],
                    low: [
                        "æœ‹å‹åœˆéª‚æ­£ä¸»æ²¡å±è”½å¥½ï¼Œç”šè‡³è¢«æˆªå›¾æµå‡ºæŒ‚åœ¨å¹¿åœºï¼Œç¤¾æ­»ã€‚",
                        "å¯¹æ–¹äººå¤šåŠ¿ä¼—ï¼Œä½ è¢«å›´æ”»äº†ï¼Œç§ä¿¡å…¨æ˜¯æ±¡è¨€ç§½è¯­ï¼Œå¿ƒæ€å´©äº†ã€‚",
                        "ä½ çš„å¤§å·è¢«æ¶æ„ä¸¾æŠ¥å°ç¦äº†ï¼Œå¤šå¹´çš„å¿ƒè¡€å½’é›¶ã€‚"
                    ]
                }
            },
            LIFE: {
                lv1: {
                    high: [
                        "èº«ä½“çš„å°æ¯›ç—…ï¼ˆè…°ç–¼/é¢ˆæ¤ç—…ï¼‰çªç„¶å¥½äº†ï¼Œèº«è½»å¦‚ç‡•ã€‚",
                        "ä½ çš„å¿«é€’å…¨éƒ½æå‰åˆ°äº†ï¼Œæ‹†å¿«é€’æ‹†åˆ°æ‰‹è½¯ã€‚",
                        "ç”šè‡³åªæ˜¯çœ‹ç€å¤©èŠ±æ¿å‘å‘†ï¼Œéƒ½è§‰å¾—ä¸–ç•Œå¾ˆç¾å¥½ï¼Œå†…å¿ƒå¹³é™ã€‚"
                    ],
                    normal: [
                        "ç¡äº†ä¸ªåˆè§‰ï¼Œç»“æœç¡å¾—å¤´æ˜è„‘æ¶¨ï¼Œä¸çŸ¥ä»Šå¤•æ˜¯ä½•å¹´ã€‚",
                        "æ‰“æ‰«å«ç”Ÿæ‰“æ‰«äº†ä¸€åŠï¼Œç´¯äº†ï¼Œå‰©ä¸‹çš„ä¸‹æ¬¡ä¸€å®šã€‚",
                        "çœ‹äº†æœ¬æ²¡è¥å…»çš„å°è¯´ï¼Œæ‰“å‘æ—¶é—´ï¼Œçœ‹å®Œå°±å¿˜ã€‚"
                    ],
                    low: [
                        "ç”šè‡³å¤–å–é€é”™äº†/æ´’äº†ï¼Œåƒäº†ä¸€é¡¿ç³Ÿå¿ƒçš„é¥­ã€‚",
                        "ç”šè‡³ç—›ç»/ç”Ÿç—…äº†ï¼Œä¸€ä¸ªäººèººåœ¨å‡ºç§Ÿå±‹é‡Œï¼Œæ„Ÿè§‰è¦æŒ‚äº†ã€‚",
                        "å‘ç°å®¶é‡Œæœ‰èŸ‘è‚/è€é¼ ï¼Œå“å¾—ä¸æ•¢ç¡è§‰ã€‚"
                    ],
                },
                lv2: {
                    high: [
                        "å‘äº†å·¥èµ„ï¼Œç¬¬ä¸€ä»¶äº‹å°±æ˜¯æŠŠè´­ç‰©è½¦é‡Œçš„é¢„å”®è°·å­å…¨æ¬¾æ‹¿ä¸‹äº†ï¼Œæœ‰é’±çœŸå¥½ã€‚",
                        "æ‘¸é±¼çœ‹åŒäººæ–‡æ²¡è¢«å‘ç°ï¼Œç”šè‡³è¿˜æŠŠå·¥ä½œæå‰åšå®Œäº†ï¼Œæ•ˆç‡çˆ†è¡¨ã€‚",
                        "è€æ¿ä»Šå¤©å¿ƒæƒ…å¥½ï¼Œè¯·å…¨å…¬å¸å–å¥¶èŒ¶ï¼Œç™½å«–çš„å¿«ä¹ã€‚"
                    ],
                    normal: [
                        "ç°å……ä¸ºäº†èµšé’±ä¹°è°·ï¼Œå¿äº†ï¼Œè¿™æ˜¯æˆ‘ä¸Šç­çš„å”¯ä¸€åŠ¨åŠ›ã€‚",
                        "åˆä¼‘æ—¶é—´å¤ªçŸ­ï¼Œåªå¤Ÿæ‰’ä¸¤å£é¥­ï¼Œæ ¹æœ¬æ²¡æ—¶é—´çœ‹ç²®ã€‚",
                        "çœ‹ç€å·¥èµ„æ¡ï¼Œæ„Ÿå¹é’±éš¾æŒ£å±éš¾åƒã€‚"
                    ],
                    low: [
                        "è€æ¿ç”šè‡³è¿˜è¦åŠ ç­ï¼Œæƒ³æ­»ï¼Œæˆ‘çš„åŒäººå›¾è¿˜å·®æœ€åäº¿ç¬”æ²¡ç”»ã€‚",
                        "çŠ¯äº†ä¸ªä½çº§é”™è¯¯è¢«å…¬å¼€å¤„åˆ‘ï¼Œæ‰£äº†ç»©æ•ˆï¼Œå¿ƒæ€å´©äº†ã€‚",
                        "ç”µè„‘æ­»æœºäº†ï¼Œåšäº†ä¸€ä¸‹åˆçš„æŠ¥è¡¨/è®ºæ–‡æ²¡ä¿å­˜ï¼Œé‚£ä¸€åˆ»ä½ æƒ³è·³æ¥¼ã€‚"
                    ]
                },
                lv3: {
                    high: [
                        "ç”šè‡³åœ¨èšä¼šä¸Šé‡åˆ°äº†ä¹Ÿæ˜¯åŒäººå¥³çš„ç°å……æœ‹å‹ï¼Œä¸¤äººèº²åœ¨è§’è½ç£•åˆ°äº†å¤©äº®ã€‚",
                        "å»KTVç‚¹äº†CPçš„è§’è‰²æ­Œï¼Œå…¨åœºåªæœ‰ä½ ä¸€ä¸ªäººå—¨ï¼Œä½†ä½ å°±æ˜¯éº¦éœ¸ã€‚",
                        "ç”šè‡³åœ¨èšä¼šä¸ŠæˆåŠŸå®‰åˆ©äº†æœ‹å‹å…¥å‘ï¼Œå¤šäº†ä¸ªé™ªä½ å‘ç–¯çš„äººã€‚"
                    ],
                    normal: [
                        "åº”ä»˜å®Œäº†ä¸‰æ¬¡å…ƒçš„èšä¼šï¼Œåªæƒ³å›å®¶èººç€ï¼Œé¢éƒ¨è‚Œè‚‰éƒ½ç¬‘åƒµäº†ã€‚",
                        "åœ¨KTVåå¦‚é’ˆæ¯¡ï¼Œåˆ«äººåœ¨å”±æ­Œï¼Œä½ åœ¨æƒ³ä½ çš„ç¨¿å­ã€‚",
                        "ç”šè‡³ä¸ºäº†åˆç¾¤å–äº†ç‚¹é…’ï¼Œç»“æœå¤´æ™•è„‘èƒ€ã€‚"
                    ],
                    low: [
                        "è¢«ç°å……æœ‹å‹æ‹‰å»çˆ¬å±±ï¼Œç´¯å¾—åƒæ¡ç‹—ï¼Œæ»¡è„‘å­éƒ½æ˜¯æˆ‘çš„CPåœ¨åºŠä¸Šæ‰“æ¶ã€‚",
                        "ç”šè‡³åœ¨èšä¼šä¸Šè¢«å‚¬å©š/å‚¬ç”Ÿï¼Œä¸ƒå¤§å§‘å…«å¤§å§¨å›´æ”»ä½ ã€‚",
                        "èšä¼šçš„åœ°æ–¹å¤ªè¿œï¼Œæ‰“è½¦èŠ±äº†å‡ ç™¾å—ï¼Œå¿ƒåœ¨æ»´è¡€ã€‚"
                    ]
                }
            }
        };

        const FANDOMS = [
            { name: 'æ¬§ç¾å†·é—¨å‰§', mode: 'General' }, 
            { name: 'å†…å¨±é€‰ç§€', mode: 'RPS' }, 
            { name: 'äºŒæ¬¡å…ƒæ‰‹æ¸¸', mode: 'ACG' }
        ];
        const TROPES = ['çƒ‚äººçœŸå¿ƒ', 'ç ´é•œé‡åœ†', 'é’æ¢…ç«¹é©¬', 'ç›¸çˆ±ç›¸æ€', 'æ°´ä»™', 'æ‹‰éƒé…'];
        const TALENTS = { 
            'æ–‡æ‰‹': ['å‘å“æå·®çš„', 'æ–‡ç¬”æƒŠè‰³çš„'], 
            'ç”»æ‰‹': ['äººä½“æè¾¹å¤§å¸ˆ', 'ç¥ä»™å…‰å½±çš„'], 
            'å‰ªè¾‘': ['ç‰¹æ•ˆå¤§ç¥çš„', 'å¡ç‚¹ç‹‚é­”'], 
            'è·¯äºº': ['å¾ˆæœ‰é’±çš„', 'çœ‹æ–‡å¿…è¯„è®ºçš„'] 
        };

        // ==========================================
        // COMPONENTS
        // ==========================================

        const AchievementBadges = ({ category, unlockedIds }) => {
            const unlocked = ACHIEVEMENTS
                .filter(a => a.category === category && unlockedIds.includes(a.id))
                .sort((a, b) => b.tier - a.tier);

            const highest = unlocked[0];

            if (!highest) {
                return (
                    <div className="w-5 h-5 rounded-full bg-gray-200 border border-gray-300 flex items-center justify-center text-[10px] text-gray-400 font-bold select-none" title="Locked">
                        {category}
                    </div>
                );
            }

            const tierColors = [
                'bg-gray-400 text-white',
                'bg-blue-500 text-white',
                'bg-purple-600 text-white',
                'bg-yellow-500 text-white border-yellow-200 shadow-sm'
            ];

            return (
                <div 
                    className={`w-5 h-5 rounded-full border border-white/20 flex items-center justify-center text-[10px] font-bold cursor-help transition-transform hover:scale-110 ${tierColors[highest.tier - 1]}`}
                    title={`${highest.name}: ${highest.description}`}
                >
                    {category}
                </div>
            );
        };

        const AchievementModal = ({ unlockedIds, onClose }) => {
            const categories = ['A', 'B', 'C', 'D'];

            return (
                <div className="fixed inset-0 bg-black/80 z-50 flex items-center justify-center p-4 animate-fadeIn" onClick={onClose}>
                    <div className="bg-[#F0F0F0] w-full max-w-lg max-h-[80vh] overflow-y-auto rounded shadow-2xl p-4" onClick={e => e.stopPropagation()}>
                        <div className="flex justify-between items-center mb-4 border-b pb-2 border-gray-300">
                            <h2 className="text-xl font-black text-[#990000] italic">ACHIEVEMENTS</h2>
                            <button onClick={onClose} className="text-2xl hover:text-[#990000]">&times;</button>
                        </div>

                        <div className="space-y-6">
                            {categories.map(cat => (
                                <div key={cat}>
                                    <h3 className="text-xs font-bold text-gray-500 mb-2 uppercase tracking-widest border-b border-gray-200">
                                        Category {cat}
                                    </h3>
                                    <div className="space-y-2">
                                        {ACHIEVEMENTS.filter(a => a.category === cat).map(ach => {
                                            const isUnlocked = unlockedIds.includes(ach.id);
                                            return (
                                                <div 
                                                    key={ach.id} 
                                                    className={`p-2 border rounded flex gap-3 ${isUnlocked ? 'bg-white border-gray-300' : 'bg-gray-100 border-gray-200 opacity-60'}`}
                                                >
                                                    <div className={`
                                                        w-10 h-10 flex-shrink-0 flex items-center justify-center font-black text-lg rounded
                                                        ${isUnlocked 
                                                            ? ach.tier === 4 ? 'bg-yellow-100 text-yellow-600' : ach.tier === 3 ? 'bg-purple-100 text-purple-600' : 'bg-gray-200 text-gray-600'
                                                            : 'bg-gray-200 text-gray-300'}
                                                    `}>
                                                        {isUnlocked ? ach.tier : '?'}
                                                    </div>
                                                    <div className="flex-1">
                                                        <div className="flex justify-between items-baseline">
                                                            <h4 className={`font-bold text-sm ${isUnlocked ? 'text-gray-800' : 'text-gray-500'}`}>
                                                                {isUnlocked ? ach.name : '???'}
                                                            </h4>
                                                            <span className="text-[10px] font-mono text-gray-400">{ach.id}</span>
                                                        </div>
                                                        <p className="text-xs text-gray-600 italic mb-1">
                                                            {isUnlocked ? ach.description : ach.conditionDesc}
                                                        </p>
                                                        {isUnlocked && (
                                                            <div className="text-[10px] bg-[#990000]/10 text-[#990000] px-1 py-0.5 rounded inline-block font-bold">
                                                                BUFF: {ach.rewardDesc}
                                                            </div>
                                                        )}
                                                    </div>
                                                </div>
                                            );
                                        })}
                                    </div>
                                </div>
                            ))}
                        </div>
                    </div>
                </div>
            );
        };

        const SettingsModal = ({ onClose, onReset }) => {
            const handleReset = () => {
                if (window.confirm('ç¡®å®šè¦é‡ç½®æ¸¸æˆå—ï¼Ÿæ‰€æœ‰è¿›åº¦å°†ä¸¢å¤±ã€‚\nAre you sure you want to reset the game? All progress will be lost.')) {
                    onReset();
                    onClose();
                }
            };

            return (
                <div className="fixed inset-0 bg-black/80 z-50 flex items-center justify-center p-4 animate-fadeIn" onClick={onClose}>
                    <div className="bg-white w-full max-w-xs rounded-lg shadow-2xl overflow-hidden" onClick={e => e.stopPropagation()}>
                        <div className="bg-gray-100 p-3 border-b border-gray-300 flex justify-between items-center">
                            <h3 className="font-bold text-gray-700">SETTINGS</h3>
                            <button onClick={onClose} className="text-gray-500 hover:text-black font-bold px-2">
                                &times;
                            </button>
                        </div>
                        
                        <div className="p-4 space-y-4">
                            <div className="text-center">
                                <h4 className="font-bold text-[#990000] mb-1">é‡ç½®æ¸¸æˆ / RESET</h4>
                                <p className="text-xs text-gray-500 mb-3">
                                    è¿”å›ä¸»èœå•é‡æ–°å¼€å§‹ã€‚<br/>å½“å‰è¿›åº¦ï¼ˆåŒ…æ‹¬æˆå°±ï¼‰å°†è¢«æ¸…é™¤ã€‚
                                </p>
                                <button 
                                    onClick={handleReset}
                                    className="w-full py-2 bg-red-100 text-red-700 border border-red-200 font-bold rounded hover:bg-red-200 transition-colors"
                                >
                                    Confirm Reset
                                </button>
                            </div>
                            
                            <div className="border-t border-gray-100 pt-4 text-center">
                                <p className="text-[10px] text-gray-400">Fangirl Simulator Refactored<br/>v1.1.0 (Events)</p>
                            </div>
                        </div>
                    </div>
                </div>
            );
        };

        // NEW: Event Modal Component
        const EventModal = ({ event, onConfirm }) => {
            if (!event) return null;

            return (
                <div className="fixed inset-0 bg-black/80 z-[60] flex items-center justify-center p-6 animate-fadeIn">
                    <div className="bg-white w-full max-w-sm border-4 border-[#990000] shadow-[10px_10px_0px_rgba(255,0,0,0.2)] animate-shake relative overflow-hidden">
                         {/* Warning Stripe */}
                         <div className="bg-[repeating-linear-gradient(45deg,#FFEB3B,#FFEB3B_10px,#000_10px,#000_20px)] h-4 w-full border-b border-black"></div>
                         
                         <div className="p-6 text-center">
                            <div className="text-4xl mb-2">âš¡</div>
                            <h3 className="text-2xl font-black text-[#990000] mb-4 italic tracking-tighter">
                                {event.name}
                            </h3>
                            <p className="text-sm font-serif text-gray-700 mb-6 leading-relaxed">
                                {event.description}
                            </p>
                            <div className="bg-gray-100 p-3 rounded border border-gray-300 mb-6">
                                <span className="text-xs font-bold text-gray-500 uppercase tracking-widest block mb-1">Effect</span>
                                <span className="text-sm font-bold text-[#990000]">{event.effectDesc}</span>
                            </div>
                            
                            <button 
                                onClick={onConfirm}
                                className="w-full py-3 bg-[#990000] text-white font-black uppercase tracking-widest hover:bg-red-800 transition-colors shadow-lg"
                            >
                                æ¥å—å‘½è¿ (ACCEPT)
                            </button>
                         </div>
                    </div>
                </div>
            );
        };

        const StatusHeader = ({ state, showAchievements, onOpenSettings }) => {
            return (
                <div className="bg-[#F0F0F0] p-3 border-b border-gray-300 shadow-sm sticky top-0 z-10">
                    <div className="flex justify-between items-center mb-2">
                        <div className="flex flex-col flex-1 overflow-hidden">
                            <div className="flex items-center gap-2">
                                <span className="bg-[#990000] text-white text-xs px-2 py-0.5 font-black uppercase tracking-wider rounded-sm">
                                    {state.jobTitle}
                                </span>
                                <span className="font-black text-gray-800 text-sm truncate max-w-[100px]">
                                    {state.playerName}
                                </span>
                                <div className="flex gap-1 ml-1" onClick={showAchievements}>
                                    {['A', 'B', 'C', 'D'].map(cat => (
                                        <AchievementBadges key={cat} category={cat} unlockedIds={state.unlockedAchievements} />
                                    ))}
                                </div>
                            </div>
                            <div className="text-[10px] text-gray-500 mt-1 truncate font-serif">
                                {state.fandom} â€¢ {state.trope}
                            </div>
                        </div>
                        <div className="flex gap-2">
                            <button onClick={onOpenSettings} className="text-lg p-1 hover:bg-gray-200 rounded text-gray-500 hover:text-black" title="Settings">
                                âš™ï¸
                            </button>
                            <button onClick={showAchievements} className="text-xl p-1 hover:bg-gray-200 rounded" title="Achievements">
                                ğŸ†
                            </button>
                        </div>
                    </div>
                    
                    <div className="grid grid-cols-5 gap-1 select-none">
                        {[
                            { l: 'WEEK', v: state.weeks },
                            { l: 'SAN', v: `${state.san}/${state.maxSan}` },
                            { l: 'MONEY', v: state.money },
                            { l: 'AP', v: `${state.ap}/${state.maxAp}` },
                            { l: 'FANS', v: state.fans }
                        ].map((s, i) => (
                            <div key={i} className="bg-white border border-gray-300 p-1 flex flex-col items-center justify-center h-10 shadow-sm">
                                <span className="text-[8px] text-gray-400 font-bold uppercase tracking-wide">{s.l}</span>
                                <span className="text-xs font-black text-[#990000]">{s.v}</span>
                            </div>
                        ))}
                    </div>
                </div>
            );
        };

        const GameLog = ({ logs }) => {
            const endRef = useRef(null);

            useEffect(() => {
                endRef.current?.scrollIntoView({ behavior: 'smooth' });
            }, [logs]);

            return (
                <div className="flex-1 overflow-y-auto p-4 space-y-3 bg-white custom-scrollbar pb-32">
                    {logs.length === 0 && (
                        <div className="text-center text-gray-400 italic mt-10 text-sm">
                            ä½ çš„åŒäººåœˆç”Ÿæ¶¯å¼€å§‹äº†... <br/>
                            Select an action below.
                        </div>
                    )}
                    {logs.map((log) => (
                        <div
                            key={log.id}
                            className={`
                                p-3 text-sm font-serif border-l-4 shadow-sm animate-fadeIn
                                ${log.type === 'danger' ? 'bg-red-50 border-red-600 text-red-900' : 
                                  log.type === 'success' ? 'bg-yellow-50 border-yellow-500 text-yellow-900' :
                                  log.type === 'event' ? 'bg-blue-50 border-blue-400 text-blue-900' :
                                  log.type === 'system' ? 'bg-gray-100 border-gray-400 text-gray-500 italic text-center border-l-0 border-b' :
                                  'bg-white border-[#990000] text-gray-800'}
                            `}
                        >
                            {log.type !== 'system' && (
                                <div className="text-[10px] text-gray-400 mb-1 font-sans uppercase tracking-widest">
                                    {log.time} â€¢ {log.type.toUpperCase()}
                                </div>
                            )}
                            <div dangerouslySetInnerHTML={{ __html: log.text }} />
                        </div>
                    ))}
                    <div ref={endRef} />
                </div>
            );
        };

        const ActionMenu = ({ 
            activeCategory, 
            actions, 
            onCategorySelect, 
            onActionSelect, 
            onNextWeek,
            ap
        }) => {
            return (
                <div className="fixed bottom-0 left-0 w-full z-40">
                    {/* Submenu Overlay */}
                    {activeCategory && (
                        <div 
                            className="bg-white border-t-4 border-[#990000] shadow-[0_-5px_20px_rgba(0,0,0,0.15)] animate-slideUp max-h-[60vh] overflow-y-auto w-full max-w-md mx-auto"
                        >
                            <div className="p-2 bg-[#990000] text-white flex justify-between items-center px-4">
                                <span className="font-bold tracking-widest">{activeCategory} ACTIONS</span>
                                <button onClick={() => onCategorySelect(null)} className="text-white text-sm opacity-80 hover:opacity-100">
                                    CLOSE â–¼
                                </button>
                            </div>
                            <div className="p-4 space-y-3 pb-24">
                                {actions.map((act) => {
                                    const canAfford = ap >= act.apCost;
                                    return (
                                        <button
                                            key={act.id}
                                            disabled={!canAfford}
                                            onClick={() => onActionSelect(act)}
                                            className={`
                                                w-full text-left p-3 border rounded-md transition-all group relative overflow-hidden
                                                ${canAfford 
                                                    ? 'bg-white border-gray-300 hover:border-[#990000] hover:shadow-md active:bg-gray-50' 
                                                    : 'bg-gray-100 border-gray-200 opacity-60 cursor-not-allowed'}
                                            `}
                                        >
                                            <div className="flex justify-between items-center mb-1 relative z-10">
                                                <span className={`font-black font-serif text-lg ${canAfford ? 'text-gray-800 group-hover:text-[#990000]' : 'text-gray-400'}`}>
                                                    {act.label}
                                                </span>
                                                <span className="text-xs bg-black text-white px-1.5 py-0.5 font-bold">
                                                    AP -{act.apCost}
                                                </span>
                                            </div>
                                            <p className="text-xs text-gray-500 italic relative z-10 pr-8">
                                                {act.intent}
                                            </p>
                                            {act.baseHeat && act.baseHeat > 0 && (
                                                <span className="absolute bottom-2 right-2 text-[10px] font-bold text-[#990000] opacity-50">
                                                    ğŸ”¥ HOT
                                                </span>
                                            )}
                                        </button>
                                    );
                                })}
                            </div>
                        </div>
                    )}

                    {/* Main Bar */}
                    <div className="bg-[#F0F0F0] border-t border-gray-300 p-2 safe-area-bottom shadow-[0_-2px_10px_rgba(0,0,0,0.1)] flex gap-2 h-16 items-stretch relative z-50 w-full max-w-md mx-auto">
                        {['PRODUCE', 'SOCIAL', 'LIFE'].map((cat) => (
                            <button
                                key={cat}
                                onClick={() => onCategorySelect(activeCategory === cat ? null : cat)}
                                className={`
                                    flex-1 border-b-4 font-bold text-sm tracking-wider transition-all
                                    ${activeCategory === cat 
                                        ? 'bg-[#990000] text-white border-black transform -translate-y-1 shadow-lg' 
                                        : 'bg-white text-gray-600 border-gray-400 hover:bg-gray-50 hover:border-[#990000] hover:text-[#990000]'}
                                `}
                            >
                                {cat === 'PRODUCE' ? 'äº§å‡º' : cat === 'SOCIAL' ? 'äº’åŠ¨' : 'ç°å……'}
                            </button>
                        ))}
                        <button
                            onClick={onNextWeek}
                            className="flex-none w-16 bg-gray-800 text-white font-black text-xs border-b-4 border-black hover:bg-black active:translate-y-0.5 active:border-b-0 transition-all rounded-sm flex items-center justify-center leading-tight"
                        >
                            NEXT<br/>WEEK
                        </button>
                    </div>
                </div>
            );
        };

        const StartScreen = ({ onStart }) => {
            const [step, setStep] = useState('input');
            const [name, setName] = useState('');
            const [profile, setProfile] = useState(null);

            const handleDraw = (jobTitle) => {
                if (!name.trim()) {
                    alert("è¯·è¾“å…¥ä½ çš„åœˆå ID / Please enter your ID");
                    return;
                }

                const jobKey = JOB_MAP[jobTitle];
                const fandomInfo = FANDOMS[Math.floor(Math.random() * FANDOMS.length)];
                const randomTrope = TROPES[Math.floor(Math.random() * TROPES.length)];
                const prefix = TALENTS[jobTitle][Math.floor(Math.random() * TALENTS[jobTitle].length)];
                
                setProfile({
                    name: prefix + name,
                    job: jobKey,
                    jobTitle: jobTitle,
                    fandom: fandomInfo.name,
                    mode: fandomInfo.mode,
                    trope: randomTrope
                });
                setStep('card');
            };

            const getJobEmoji = (job) => {
                switch(job) {
                    case 'æ–‡æ‰‹': return 'âœ’ï¸';
                    case 'ç”»æ‰‹': return 'ğŸ¨';
                    case 'å‰ªè¾‘': return 'âœ‚ï¸';
                    default: return 'ğŸ•¶ï¸';
                }
            };

            if (step === 'card' && profile) {
                return (
                    <div className="flex flex-col h-screen items-center justify-center bg-[#F0F0F0] p-6 animate-fadeIn w-full">
                        <div className="bg-white border-4 border-[#990000] p-6 shadow-[10px_10px_0px_rgba(0,0,0,0.1)] w-full max-w-sm relative">
                            <div className="absolute top-2 right-2 text-[#990000] font-black text-xs border border-[#990000] px-1">ID CARD</div>
                            
                            <div className="flex flex-col items-center mb-6">
                                <div className="w-20 h-20 bg-gray-100 rounded-full flex items-center justify-center text-4xl border-2 border-gray-300 mb-3 shadow-inner">
                                    {getJobEmoji(profile.jobTitle)}
                                </div>
                                <h2 className="text-xl font-black text-gray-800 text-center">{profile.name}</h2>
                                <span className="text-xs bg-black text-white px-2 py-0.5 font-bold uppercase tracking-widest mt-1">
                                    {profile.jobTitle}
                                </span>
                            </div>

                            <div className="space-y-3 mb-8 border-t border-b border-gray-200 py-4">
                                <div className="flex justify-between items-center">
                                    <span className="text-gray-400 text-xs font-bold uppercase">Fandom</span>
                                    <span className="text-gray-800 font-serif font-bold">{profile.fandom}</span>
                                </div>
                                <div className="flex justify-between items-center">
                                    <span className="text-gray-400 text-xs font-bold uppercase">Type</span>
                                    <span className="text-gray-800 font-serif font-bold">{profile.mode}</span>
                                </div>
                                <div className="flex justify-between items-center">
                                    <span className="text-gray-400 text-xs font-bold uppercase">Trope</span>
                                    <span className="text-[#990000] font-serif font-bold italic">{profile.trope}</span>
                                </div>
                            </div>

                            <div className="flex gap-2">
                                <button 
                                    onClick={() => setStep('input')}
                                    className="flex-1 py-3 bg-gray-200 text-gray-600 font-bold text-sm hover:bg-gray-300 transition-colors"
                                >
                                    é‡æ¥ (RE-ROLL)
                                </button>
                                <button 
                                    onClick={() => onStart(profile)}
                                    className="flex-[2] py-3 bg-[#990000] text-white font-black text-sm tracking-widest hover:bg-red-800 transition-colors shadow-lg"
                                >
                                    ç¡®è®¤å…¥å‘ (START)
                                </button>
                            </div>
                        </div>
                    </div>
                );
            }

            return (
                <div className="flex flex-col h-screen items-center justify-center bg-[#F0F0F0] p-6 space-y-8 animate-fadeIn w-full">
                    <div className="text-center">
                        <h1 className="text-5xl font-black italic text-[#990000] mb-2 tracking-tighter">åŒäººå¥³<br/>æ¨¡æ‹Ÿå™¨</h1>
                        <p className="text-gray-400 text-xs italic border-t border-gray-300 pt-2 tracking-widest">FANGIRL SIMULATOR REFACTORED</p>
                    </div>
                    
                    <input 
                        type="text" 
                        placeholder="è¾“å…¥ä½ çš„åœˆå ID..." 
                        className="w-full max-w-xs p-4 border-b-2 border-gray-300 bg-transparent text-center outline-none focus:border-[#990000] text-xl font-serif placeholder-gray-400 transition-colors"
                        value={name} 
                        onChange={e => setName(e.target.value)} 
                    />

                    <div className="grid grid-cols-2 gap-4 w-full max-w-xs">
                        {Object.keys(JOB_MAP).map(jobTitle => (
                            <button 
                                key={jobTitle}
                                onClick={() => name && handleDraw(jobTitle)}
                                className="bg-white border border-gray-300 border-b-4 border-b-gray-400 py-3 font-bold text-gray-700 hover:text-[#990000] hover:border-[#990000] active:border-b active:translate-y-0.5 transition-all"
                            >
                                {jobTitle}
                            </button>
                        ))}
                    </div>
                    
                    {!name && <div className="text-gray-400 text-xs italic">Please enter name to select job</div>}
                </div>
            );
        };

        // NEW: Detailed Settlement Screen
        const SettlementScreen = ({ state, onRestart }) => {
            const endingTitle = state.san <= 0 ? "BE: èµ›åšç–¯å­" : "BE: è¿›å‚æ‰“å·¥";
            const endingDesc = state.san <= 0 
                ? "ä½ Sanå€¼å½’é›¶ï¼Œå‘ç–¯é€€ç½‘äº†ã€‚ä»æ­¤æ±Ÿæ¹–ä¸Šåªç•™ä¸‹äº†ä½ çš„ä¼ è¯´ï¼ˆå’Œä¸€å †å‘ï¼‰ã€‚" 
                : "ä½ ç ´äº§äº†ï¼Œè¢«è¿«å›å½’ä¸‰æ¬¡å…ƒæ‰“å·¥ã€‚åŒäººæ¢¦ç¢ï¼Œç°å®çœŸè‹¦ã€‚";

            return (
                <div className="fixed inset-0 bg-[#333] z-50 flex flex-col items-center justify-center p-6 text-white text-center animate-fadeIn overflow-y-auto">
                    <div className="w-full max-w-md">
                        <h2 className="text-5xl font-black text-[#990000] mb-2 italic tracking-tighter">{endingTitle}</h2>
                        <p className="text-sm text-gray-300 mb-8 font-serif leading-relaxed px-4 border-b border-gray-600 pb-4">
                            {endingDesc}
                        </p>
                        
                        <div className="grid grid-cols-2 gap-2 mb-6">
                            <div className="bg-white/5 p-3 border border-white/10 rounded">
                                <div className="text-[10px] text-gray-400 uppercase tracking-widest">Total Fans</div>
                                <div className="text-xl font-bold font-serif">{state.fans.toLocaleString()}</div>
                            </div>
                            <div className="bg-white/5 p-3 border border-white/10 rounded">
                                <div className="text-[10px] text-gray-400 uppercase tracking-widest">Weeks</div>
                                <div className="text-xl font-bold font-serif">{state.weeks}</div>
                            </div>
                            <div className="bg-white/5 p-3 border border-white/10 rounded">
                                <div className="text-[10px] text-gray-400 uppercase tracking-widest">Highest Heat</div>
                                <div className="text-xl font-bold font-serif">{state.maxSingleHeat.toLocaleString()}</div>
                            </div>
                            <div className="bg-white/5 p-3 border border-white/10 rounded">
                                <div className="text-[10px] text-gray-400 uppercase tracking-widest">Works</div>
                                <div className="text-xl font-bold font-serif">{state.worksCount}</div>
                            </div>
                        </div>

                        <div className="mb-8 text-left">
                            <h3 className="text-xs font-bold text-gray-500 uppercase tracking-widest mb-3 text-center">Unlocked Achievements</h3>
                            <div className="flex flex-wrap gap-2 justify-center">
                                {ACHIEVEMENTS.map(ach => {
                                    const isUnlocked = state.unlockedAchievements.includes(ach.id);
                                    return (
                                        <div 
                                            key={ach.id}
                                            className={`w-8 h-8 rounded border flex items-center justify-center text-xs font-bold
                                                ${isUnlocked 
                                                    ? 'bg-[#990000] border-[#990000] text-white shadow-[0_0_10px_rgba(153,0,0,0.5)]' 
                                                    : 'bg-transparent border-gray-700 text-gray-700'}`}
                                            title={ach.name}
                                        >
                                            {isUnlocked ? ach.category : '?'}
                                        </div>
                                    );
                                })}
                            </div>
                        </div>

                        <button 
                            className="w-full py-4 bg-white text-black font-black uppercase tracking-widest hover:bg-gray-200 transition-colors shadow-xl"
                            onClick={onRestart}
                        >
                            RESTART GAME
                        </button>
                    </div>
                </div>
            );
        };

        // ==========================================
        // MAIN APP
        // ==========================================

        const App = () => {
            const [view, setView] = useState('start');
            const [activeMenu, setActiveMenu] = useState(null);
            const [activeEvent, setActiveEvent] = useState(null); // NEW: State for current event modal
            const [showAchievements, setShowAchievements] = useState(false);
            const [showSettings, setShowSettings] = useState(false);
            const [logs, setLogs] = useState([]);
            
            const [state, setState] = useState({
                playerName: '', job: 'writer', jobTitle: 'æ–‡æ‰‹', fandom: '', trope: '',
                weeks: 1, san: 100, maxSan: 100, money: 5000, heat: 0, fans: 0, 
                ap: 5, maxAp: 5, moe: 0, toxic: 0, worksCount: 0,
                maxSingleHeat: 0, consecutiveNoProduce: 0, consecutiveLow: 0, hasRevived: false,
                isGameOver: false, unlockedAchievements: [], forceHighNext: false,
                // New state fields
                shadowBanWeeks: 0,
                scandalActive: false
            });

            const checkAchievements = useCallback((currentState) => {
                const newUnlocked = [];
                const { unlockedAchievements } = currentState;

                const unlock = (id) => {
                    if (!unlockedAchievements.includes(id)) {
                        newUnlocked.push(id);
                    }
                };

                // A: æ™‹å‡
                if (currentState.worksCount === 1 && currentState.heat < 1000) unlock('ACH_01');
                if (currentState.maxSingleHeat > 5000) unlock('ACH_02');
                if (currentState.heat > 20000) unlock('ACH_03');
                if (currentState.heat > 100000) unlock('ACH_04');

                // B: è´¢å¯Œ
                if (currentState.money < 500) unlock('ACH_05');
                if (currentState.money > 50000) unlock('ACH_06');
                if (currentState.worksCount > 50) unlock('ACH_07');
                if (currentState.consecutiveNoProduce >= 4) unlock('ACH_08');

                // C: æ€§æ ¼
                if (currentState.moe > 80) unlock('ACH_09');
                if (currentState.toxic > 80) unlock('ACH_10');
                if (currentState.weeks >= 96 && currentState.moe < 20 && currentState.toxic < 20) unlock('ACH_11');

                // D: å½©è›‹
                if (currentState.san === 1 && !currentState.isGameOver) unlock('ACH_12');
                if (currentState.consecutiveLow >= 3) unlock('ACH_13');

                if (newUnlocked.length > 0) {
                    newUnlocked.forEach(id => {
                        const ach = ACHIEVEMENTS.find(a => a.id === id);
                        addLog(`ğŸ† <b>è§£é”æˆå°±: ${ach?.name}</b> - ${ach?.rewardDesc}`, 'success');
                    });
                    return { ...currentState, unlockedAchievements: [...currentState.unlockedAchievements, ...newUnlocked] };
                }
                return currentState;
            }, []);

            const addLog = useCallback((text, type = 'action') => {
                const time = new Date().toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });
                setLogs(prev => [...prev, { id: Math.random(), text, type, time }]);
            }, []);

            const startGame = (profile) => {
                setState({
                    ...state,
                    playerName: profile.name,
                    job: profile.job,
                    jobTitle: profile.jobTitle,
                    fandom: profile.fandom,
                    trope: profile.trope,
                    
                    weeks: 1, san: 100, maxSan: 100, money: 5000, heat: 0, fans: 0, 
                    ap: 5, maxAp: 5,
                    moe: 0, toxic: 0, worksCount: 0,
                    maxSingleHeat: 0, consecutiveNoProduce: 0, consecutiveLow: 0, hasRevived: false,
                    isGameOver: false, unlockedAchievements: [], forceHighNext: false,
                    shadowBanWeeks: 0, scandalActive: false
                });
                setLogs([]);
                addLog(`æ¬¢è¿æ¥åˆ°åŒäººåœˆã€‚ä½ çš„èº«ä»½æ˜¯ <b>${profile.job.toUpperCase()}</b>.`, 'system');
                addLog(`å…¥å‘äº† <b>${profile.fandom}</b> (${profile.mode})ã€‚`, 'system');
                addLog(`ä½ çš„å±æ€§æ˜¯ï¼š<b>${profile.trope}</b>`, 'system');
                setView('game');
            };

            // NEW: Apply Event Logic when confirmed
            const handleEventConfirm = () => {
                if (!activeEvent) return;
                
                setState(prev => {
                    let next = { ...prev };
                    const logic = activeEvent.logic;

                    if (logic.san) next.san = Math.max(0, next.san + logic.san);
                    if (logic.money) next.money += logic.money;
                    if (logic.heat) next.heat += logic.heat;
                    if (logic.toxic) next.toxic += logic.toxic;
                    
                    if (logic.apZero) next.ap = 0;
                    if (logic.buff === 'shadow_ban') next.shadowBanWeeks = logic.buffDuration;
                    if (logic.triggerFlag === 'scandal_active') next.scandalActive = true;
                    // Note: skipTurn logic is handled implicitly by consuming AP or user just not having actions

                    // Check Game Over immediately after event
                    if (next.san <= 0) {
                        if (!next.hasRevived && next.unlockedAchievements.includes('ACH_12')) {
                            next.san = 20;
                            next.hasRevived = true;
                            addLog('ğŸ’” SANå€¼å½’é›¶... ä½†æ˜¯ï¼ã€å¼ºå¿ƒè„ã€‘å‘åŠ¨ï¼å‚æ­»ç—…ä¸­æƒŠåèµ·ï¼', 'success');
                        } else {
                            next.isGameOver = true;
                        }
                    }
                    if (next.money < 0) next.isGameOver = true;

                    return next;
                });

                addLog(`âš ï¸ <b>äº‹ä»¶ç”Ÿæ•ˆ:</b> ${activeEvent.name}`, 'danger');
                setActiveEvent(null);
            };

            const handleNextWeek = () => {
                // 1. Regular Update
                setState(prev => {
                    let nextState = { ...prev };
                    
                    // Salary
                    const isPayday = nextState.weeks % 4 === 0;
                    const salary = 5000;
                    const livingCost = 400;
                    let income = isPayday ? salary : 0;
                    
                    nextState.money = nextState.money + income - livingCost;
                    nextState.weeks += 1;
                    
                    // Buffs/Debuffs
                    const maxApBuff = prev.unlockedAchievements.includes('ACH_07') ? 1 : 0;
                    nextState.ap = prev.maxAp + maxApBuff;
                    nextState.consecutiveNoProduce += 1;
                    if (nextState.shadowBanWeeks > 0) nextState.shadowBanWeeks -= 1;

                    // Logs
                    addLog(`--- ç¬¬ ${nextState.weeks} å‘¨ ---`, 'system');
                    if (isPayday) addLog(`ğŸ’¸ å‘å·¥èµ„äº†ï¼+${salary}`, 'success');
                    addLog(`æ”¯ä»˜ç”Ÿæ´»è´¹ ${livingCost}ã€‚`, 'system');
                    
                    if (nextState.scandalActive) {
                        // Scandal follow-up chance
                        if (Math.random() < 0.3) {
                            addLog(`â˜ ï¸ å¡Œæˆ¿ä½™æ³¢ï¼šä½ è¢«æç«¯ç²‰å†²äº†ï¼ŒSAN -10`, 'danger');
                            nextState.san -= 10;
                        }
                    }

                    // Check Game Over conditions from money
                    if (nextState.money < 0) nextState.isGameOver = true;

                    return nextState;
                });
                
                setActiveMenu(null);

                // 2. Trigger Event Check
                // Needs to access latest state, so we use a timeout or assume pre-event state is close enough for threshold
                // We'll calculate threshold based on current state (before update) for simplicity
                const threshold = state.san < 20 ? 0.4 : 0.2;
                
                if (Math.random() < threshold) {
                    const evt = RANDOM_EVENTS[Math.floor(Math.random() * RANDOM_EVENTS.length)];
                    setTimeout(() => setActiveEvent(evt), 100); // Small delay for visual pacing
                }
            };

            const handleAction = (act) => {
                let cost = act.apCost;
                
                const isHighTier = act.id === 'lv2' || act.id === 'lv3';
                let moneyCost = 0;
                if (act.baseMoneyChange < 0) {
                    moneyCost = Math.abs(act.baseMoneyChange);
                    if (state.unlockedAchievements.includes('ACH_06') && isHighTier) {
                        moneyCost = Math.floor(moneyCost * 0.8);
                    }
                }

                if (state.ap < cost) return;

                const roll = Math.random();
                let luck = 'normal';
                
                const highThreshold = state.unlockedAchievements.includes('ACH_02') ? 0.6 : 0.8;
                if (state.forceHighNext) {
                    luck = 'high';
                } else {
                    if (roll > highThreshold) luck = 'high';
                    else if (roll < 0.2) luck = 'low';
                }

                let flavorCategory = 'writer';
                if (activeMenu === 'PRODUCE') flavorCategory = state.job;
                else if (activeMenu === 'SOCIAL') flavorCategory = 'SOCIAL';
                else if (activeMenu === 'LIFE') flavorCategory = 'LIFE';

                const flavorData = FLAVOR_TEXT[flavorCategory]?.[act.id];
                let logText = act.intent;
                if (flavorData) {
                    const texts = flavorData[luck];
                    logText = texts[Math.floor(Math.random() * texts.length)];
                }

                let sanDelta = act.baseSanChange;
                let moneyDelta = act.baseMoneyChange;
                if (moneyDelta < 0) moneyDelta = -moneyCost;
                
                let heatGain = 0;
                if (activeMenu === 'PRODUCE') {
                    // Check Shadow Ban
                    if (state.shadowBanWeeks > 0) {
                        heatGain = 0;
                        logText += " (ä½†æ˜¯è¢«é™æµäº†ï¼Œçƒ­åº¦ +0)";
                    } else {
                        // CRITICAL: RETAINED HYPE ALGORITHM
                        let base = 50;
                        if (act.id === 'lv2') base = 200;
                        if (act.id === 'lv3') base = 800;

                        const variance = 0.8 + Math.random() * 0.4;
                        const fanMult = 1 + (state.heat / 5000);
                        
                        let crit = 1.0;
                        if (luck === 'high') crit = 1.5;
                        if (luck === 'low') crit = 0.5;
                        
                        heatGain = Math.floor((base * variance) * fanMult * crit);

                        if (state.unlockedAchievements.includes('ACH_01') && state.heat < 1000) {
                            heatGain = Math.floor(heatGain * 1.1);
                        }
                        if (state.unlockedAchievements.includes('ACH_03')) {
                            heatGain = Math.floor(heatGain * 1.5);
                        }
                        if (state.unlockedAchievements.includes('ACH_04')) {
                            heatGain = heatGain * 2;
                        }
                    }
                } else {
                    heatGain = act.baseHeat || 0;
                    if (activeMenu === 'SOCIAL' && act.id === 'lv3' && state.unlockedAchievements.includes('ACH_10')) {
                        heatGain = Math.floor(heatGain * 1.5);
                    }
                }

                if (state.unlockedAchievements.includes('ACH_05') && activeMenu === 'LIFE' && act.id === 'lv2') {
                    moneyDelta = Math.floor(moneyDelta * 1.2);
                }
                if (state.unlockedAchievements.includes('ACH_08') && sanDelta < 0) {
                    sanDelta = Math.min(0, sanDelta + 5);
                }
                if (state.unlockedAchievements.includes('ACH_09') && sanDelta > 0 && activeMenu === 'SOCIAL') {
                    sanDelta = Math.floor(sanDelta * 1.5);
                }

                const currentMaxSan = state.unlockedAchievements.includes('ACH_11') ? state.maxSan + 20 : state.maxSan;

                setState(prev => {
                    let newState = { ...prev };
                    
                    newState.ap -= cost;

                    newState.san = Math.min(currentMaxSan, Math.max(0, prev.san + sanDelta));
                    newState.money += moneyDelta;
                    newState.heat += heatGain;
                    newState.fans += Math.floor(heatGain / 10);
                    
                    if (activeMenu === 'PRODUCE') {
                        newState.worksCount += 1;
                        newState.consecutiveNoProduce = 0;
                        newState.maxSingleHeat = Math.max(newState.maxSingleHeat, heatGain);
                        
                        if (luck === 'low') newState.consecutiveLow += 1;
                        else newState.consecutiveLow = 0;
                    }

                    if (activeMenu === 'SOCIAL') {
                        if (act.id === 'lv1') newState.moe += 2;
                        if (act.id === 'lv3') newState.toxic += 2;
                    }

                    newState.forceHighNext = false; 

                    if (newState.san <= 0) {
                        if (!newState.hasRevived && newState.unlockedAchievements.includes('ACH_12')) {
                            newState.san = 20; 
                            newState.hasRevived = true;
                            addLog('ğŸ’” SANå€¼å½’é›¶... ä½†æ˜¯ï¼ã€å¼ºå¿ƒè„ã€‘å‘åŠ¨ï¼å‚æ­»ç—…ä¸­æƒŠåèµ·ï¼', 'success');
                        } else {
                            newState.isGameOver = true;
                        }
                    }
                    if (newState.money < 0) {
                        newState.isGameOver = true;
                    }

                    newState = checkAchievements(newState);
                    
                    if (newState.consecutiveLow >= 3 && newState.unlockedAchievements.includes('ACH_13')) {
                        newState.forceHighNext = true;
                        newState.consecutiveLow = 0; 
                        addLog('âœ¨ ã€éé…‹ä¹‹ç‹ã€‘è§¦å‘ï¼šå„è¿åˆ°äº†æè‡´å°±æ˜¯å¹¸è¿ã€‚ä¸‹ä¸€æ¬¡äº§å‡ºå¿…å®š Highï¼', 'success');
                    }

                    return newState;
                });

                const type = luck === 'high' ? 'success' : luck === 'low' ? 'danger' : 'action';
                addLog(logText, type);
                
                if (heatGain > 0) {
                    let icon = '';
                    if (heatGain > 10000) icon = 'ğŸ‘‘ ';
                    else if (heatGain > 2000) icon = 'ğŸ”¥ ';
                    
                    addLog(`${icon}çƒ­åº¦ +${heatGain.toLocaleString()} | ç²‰ä¸ +${Math.floor(heatGain/10)}`, heatGain > 2000 ? 'success' : 'event');
                }
                
                if (moneyDelta !== 0) addLog(`ğŸ’° é‡‘é’± ${moneyDelta > 0 ? '+' : ''}${moneyDelta}`, 'event');
                if (sanDelta !== 0) addLog(`â¤ï¸ SAN ${sanDelta > 0 ? '+' : ''}${sanDelta}`, sanDelta < 0 ? 'danger' : 'event');
                
                setActiveMenu(null);
            };

            const getActiveActions = () => {
                if (!activeMenu) return [];
                if (activeMenu === 'PRODUCE') return ACTIONS[state.job];
                return ACTIONS[activeMenu];
            };

            if (view === 'start') return <StartScreen onStart={startGame} />;

            return (
                <div className="w-full h-full flex flex-col relative">
                    <StatusHeader 
                        state={state} 
                        showAchievements={() => setShowAchievements(true)}
                        onOpenSettings={() => setShowSettings(true)}
                    />

                    <GameLog logs={logs} />

                    <ActionMenu 
                        activeCategory={activeMenu}
                        actions={getActiveActions()}
                        onCategorySelect={setActiveMenu}
                        onActionSelect={handleAction}
                        onNextWeek={handleNextWeek}
                        ap={state.ap}
                    />

                    {showAchievements && (
                        <AchievementModal 
                            unlockedIds={state.unlockedAchievements} 
                            onClose={() => setShowAchievements(false)} 
                        />
                    )}
                    
                    {showSettings && (
                        <SettingsModal 
                            onClose={() => setShowSettings(false)}
                            onReset={() => {
                                setView('start');
                                setShowSettings(false);
                            }}
                        />
                    )}

                    {/* NEW: Event Modal Layer */}
                    {activeEvent && (
                        <EventModal 
                            event={activeEvent}
                            onConfirm={handleEventConfirm}
                        />
                    )}

                    {/* UPDATED: Settlement Screen */}
                    {state.isGameOver && (
                        <SettlementScreen state={state} onRestart={() => setView('start')} />
                    )}
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>